<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.47" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/posts/docker/"><meta property="og:site_name" content="cv blog"><meta property="og:title" content="狂神说Docker"><meta property="og:description" content="狂神说Docker 版权声明：狂神说Docker 不为任何机构站台，编程是爱好，恭喜你发现宝藏男孩一枚~希望你们关注我是因为喜欢我！ 所有的课程都是免费的，任何利用我课程收费的都是骗子，请大家注意！ B站唯一账号：狂神说Java 唯一公众号：狂神说 学习前，三连关注分享支持，是最基本的尊重，拒绝白嫖！ image-20200510142427957im..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-06-13T17:29:26.000Z"><meta property="article:author" content="cv"><meta property="article:modified_time" content="2024-06-13T17:29:26.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"狂神说Docker","image":[""],"dateModified":"2024-06-13T17:29:26.000Z","author":[{"@type":"Person","name":"cv","url":"https://github.com/lwflsq"}]}</script><title>狂神说Docker | cv blog</title><meta name="description" content="狂神说Docker 版权声明：狂神说Docker 不为任何机构站台，编程是爱好，恭喜你发现宝藏男孩一枚~希望你们关注我是因为喜欢我！ 所有的课程都是免费的，任何利用我课程收费的都是骗子，请大家注意！ B站唯一账号：狂神说Java 唯一公众号：狂神说 学习前，三连关注分享支持，是最基本的尊重，拒绝白嫖！ image-20200510142427957im...">
    <link rel="preload" href="/assets/style-BKoMlfeF.css" as="style"><link rel="stylesheet" href="/assets/style-BKoMlfeF.css">
    <link rel="modulepreload" href="/assets/app-BzPplCq-.js"><link rel="modulepreload" href="/assets/index.html-Ct0U5oQC.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-ChlHUmLl.js" as="script"><link rel="prefetch" href="/assets/intro.html-B2Ksy7K8.js" as="script"><link rel="prefetch" href="/assets/index.html-G8TuZ_Li.js" as="script"><link rel="prefetch" href="/assets/intro.html-B8SFe9Hx.js" as="script"><link rel="prefetch" href="/assets/index.html-Coq9v-FM.js" as="script"><link rel="prefetch" href="/assets/disable.html-CK5GfCVx.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-CeU9qiGJ.js" as="script"><link rel="prefetch" href="/assets/layout.html-BGir9OaB.js" as="script"><link rel="prefetch" href="/assets/markdown.html-DdSkN7DB.js" as="script"><link rel="prefetch" href="/assets/page.html-DHKBMtTw.js" as="script"><link rel="prefetch" href="/assets/cherry.html-DfWO6mZ-.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-DKSKuaVm.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-CyNMzOzA.js" as="script"><link rel="prefetch" href="/assets/tomato.html-BH_eXjZW.js" as="script"><link rel="prefetch" href="/assets/index.html-BpRmgeXT.js" as="script"><link rel="prefetch" href="/assets/index.html-DQhOnprc.js" as="script"><link rel="prefetch" href="/assets/1.html-Dsx1LOwR.js" as="script"><link rel="prefetch" href="/assets/index.html-C9GFJaND.js" as="script"><link rel="prefetch" href="/assets/datatype.html-CFsxmefl.js" as="script"><link rel="prefetch" href="/assets/type-conversions.html-BegxDJwS.js" as="script"><link rel="prefetch" href="/assets/index.html-_uyEtZx8.js" as="script"><link rel="prefetch" href="/assets/index.html--EZGe4hP.js" as="script"><link rel="prefetch" href="/assets/1.html-BBeZSx7d.js" as="script"><link rel="prefetch" href="/assets/2.html-umUuIr2X.js" as="script"><link rel="prefetch" href="/assets/3.html-6mk9cYtl.js" as="script"><link rel="prefetch" href="/assets/4.html-C-cwvBC0.js" as="script"><link rel="prefetch" href="/assets/1.html-Di558_WG.js" as="script"><link rel="prefetch" href="/assets/2.html-DeS3gFZv.js" as="script"><link rel="prefetch" href="/assets/3.html-gaOhrLXz.js" as="script"><link rel="prefetch" href="/assets/4.html-CKDuUj8H.js" as="script"><link rel="prefetch" href="/assets/404.html-B7-VNU5F.js" as="script"><link rel="prefetch" href="/assets/index.html-BDpSNqzA.js" as="script"><link rel="prefetch" href="/assets/index.html-B7Tb0r5a.js" as="script"><link rel="prefetch" href="/assets/index.html-DZro4xFu.js" as="script"><link rel="prefetch" href="/assets/index.html-DXgsV0OG.js" as="script"><link rel="prefetch" href="/assets/index.html-Ba0yttEK.js" as="script"><link rel="prefetch" href="/assets/index.html-D1uUc1Eh.js" as="script"><link rel="prefetch" href="/assets/index.html-DB35Ce0Q.js" as="script"><link rel="prefetch" href="/assets/index.html-DPNfOtlX.js" as="script"><link rel="prefetch" href="/assets/index.html-7bcDxtyZ.js" as="script"><link rel="prefetch" href="/assets/index.html-z6Q2Chac.js" as="script"><link rel="prefetch" href="/assets/index.html-Dp4SoOe7.js" as="script"><link rel="prefetch" href="/assets/index.html-D6SmEZjl.js" as="script"><link rel="prefetch" href="/assets/index.html-DUnIUsOs.js" as="script"><link rel="prefetch" href="/assets/index.html-C7AzmC4u.js" as="script"><link rel="prefetch" href="/assets/index.html-3kU4o37M.js" as="script"><link rel="prefetch" href="/assets/index.html-f5ABn2JC.js" as="script"><link rel="prefetch" href="/assets/index.html-BwCnI7vk.js" as="script"><link rel="prefetch" href="/assets/index.html-CvAWcS04.js" as="script"><link rel="prefetch" href="/assets/index.html-B-ACZADq.js" as="script"><link rel="prefetch" href="/assets/index.html-CRalld3d.js" as="script"><link rel="prefetch" href="/assets/index.html-CeJSnJZ1.js" as="script"><link rel="prefetch" href="/assets/index.html-TWYNsUvJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DXo8HLg8.js" as="script"><link rel="prefetch" href="/assets/index.html-CfFvs9hn.js" as="script"><link rel="prefetch" href="/assets/index.html-Bx3wR3oG.js" as="script"><link rel="prefetch" href="/assets/index.html-C4fKbKb-.js" as="script"><link rel="prefetch" href="/assets/index.html-CQZuGODz.js" as="script"><link rel="prefetch" href="/assets/index.html-Bz7kDiLc.js" as="script"><link rel="prefetch" href="/assets/index.html-EB3BGuA9.js" as="script"><link rel="prefetch" href="/assets/index.html-Cxasr-u6.js" as="script"><link rel="prefetch" href="/assets/index.html-BJEZaK3u.js" as="script"><link rel="prefetch" href="/assets/index.html-ZzxKXsZ-.js" as="script"><link rel="prefetch" href="/assets/index.html-D8TXepgQ.js" as="script"><link rel="prefetch" href="/assets/index.html-Dve64Mek.js" as="script"><link rel="prefetch" href="/assets/index.html-Ctf4KlW2.js" as="script"><link rel="prefetch" href="/assets/index-i8UmRVOU.js" as="script"><link rel="prefetch" href="/assets/index-DRWmbcXV.js" as="script"><link rel="prefetch" href="/assets/index-AxlX3bpC.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://mp-e8d39265-f804-4268-b106-f7990e4ce87e.cdn.bspapp.com/cloudstorage/logo.png" alt><!----><span class="vp-site-name hide-in-pad">cv blog</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="博客主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->博客主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="博文"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>博文<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/uniapp/" aria-label="UniApp"><!---->UniApp<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/vue/" aria-label="Vue"><!---->Vue<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/javascript/" aria-label="前端开发"><!---->前端开发<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="Java学习"><!---->Java学习<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/gdzsb/" aria-label="广东专升本报名"><!---->广东专升本报名<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/docker/" aria-label="狂神说Docker"><!---->狂神说Docker<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="https://github.com/lwflsq/lwf-blog" aria-label="github仓库" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><!--]-->github仓库<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/intro.html" aria-label="个人简介"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><!--]-->个人简介<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/docker/" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/en/" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/posts/docker/" aria-label="狂神说Docker"><!---->狂神说Docker<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->狂神说Docker</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/lwflsq" target="_blank" rel="noopener noreferrer">cv</a></span><span property="author" content="cv"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-06-13T17:29:26.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 66 分钟</span><meta property="timeRequired" content="PT66M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#docker为什么出现">Docker为什么出现</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#docker能干嘛">Docker能干嘛</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#docker的基本组成">Docker的基本组成</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#环境说明">环境说明</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#安装步骤">安装步骤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#docker镜像阿里云镜像加速">Docker镜像阿里云镜像加速</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#底层原理">底层原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#帮助命令">帮助命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#镜像命令">镜像命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#容器命令">容器命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#常用其他命令">常用其他命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#小结">小结</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#作业练习">作业练习</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#可视化">可视化</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#镜像是什么">镜像是什么</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#docker镜像加载原理">Docker镜像加载原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#分层理解">分层理解</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#镜像commit">镜像Commit</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#什么是容器数据卷">什么是容器数据卷</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#使用数据卷">使用数据卷</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#匿名和具名挂载">匿名和具名挂载</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#数据卷容器">数据卷容器</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#什么是dockerfile">什么是DockerFile</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dockerfile构建过程">DockerFile构建过程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#dockerfile指令">DockerFile指令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#实战测试">实战测试</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#发布镜像">发布镜像</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#总结">总结</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#理解docker0">理解Docker0</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#link">--Link</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#自定义网络">自定义网络</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#网络连通">网络连通</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#实战-部署一个redis集群">实战：部署一个Redis集群</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#创建项目">创建项目</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#打包镜像">打包镜像</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#idea安装插件">IDEA安装插件</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="狂神说docker" tabindex="-1"><a class="header-anchor" href="#狂神说docker"><span>狂神说Docker</span></a></h1><blockquote><p>版权声明：狂神说Docker</p></blockquote><p>不为任何机构站台，编程是爱好，恭喜你发现宝藏男孩一枚~希望你们关注我是因为喜欢我！</p><p>所有的课程都是免费的，任何利用我课程收费的都是骗子，请大家注意！</p><p>B站唯一账号：狂神说Java 唯一公众号：狂神说</p><p>学习前，三连关注分享支持，是最基本的尊重，拒绝白嫖！</p><figure><img src="/assets/image-20200510142427957-B9oMBClK.png" alt="image-20200510142427957" tabindex="0" loading="lazy"><figcaption>image-20200510142427957</figcaption></figure><p>给大家聊聊三体的一句话，很有感触：弱小和无知不是生存的障碍，傲慢才是。</p><h1 id="docker概述" tabindex="-1"><a class="header-anchor" href="#docker概述"><span>Docker概述</span></a></h1><h2 id="docker为什么出现" tabindex="-1"><a class="header-anchor" href="#docker为什么出现"><span>Docker为什么出现</span></a></h2><p>一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环境的兼容，对运维人员是极大的考验！</p><p>环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，==软件可以带环境安装？==也就是说，安装的时候，把原始环境一模一样地复制过来。解决开发人员说的“ 在我的机器上可正常工作”的问题。</p><p>之前在服务器配置一个应用的运行环境，要安装各种软件，就拿一个基本的工程项目的环境来说吧，Java/Tomcat/MySQL/JDBC驱动包等。安装和配置这些东西有多麻烦就不说了，它还不能跨平台。假如我们是在 Windows 上安装的这些环境，到了 Linux 又得重新装。况且就算不跨操作系统，换另一台同样操作系统的服务器，要移植应用也是非常麻烦的。</p><p>传统上认为，软件编码开发/测试结束后，所产出的成果即是程序或是能够编译执行的二进制字节码文件等（Java为例）。而为了让这些程序可以顺利执行，开发团队也得准备完整的部署文件，让维运团队得以部署应用程式，<strong>开发需要清楚的告诉运维部署团队，用的全部配置文件+所有软件环境。不过，即便如此，仍然常常发生部署失败的状况。</strong></p><p>Docker之所以发展如此迅速，也是因为它对此给出了一个标准化的解决方案。</p><p>Docker镜像的设计，<mark>使得Docker得以打破过去「程序即应用」的观念。通过Docker镜像 ( images ) 将应用程序所需要的系统环境，由下而上打包，达到应用程序跨平台间的无缝接轨运作。</mark></p><figure><img src="/assets/image-20200509122554545-DahknPXY.png" alt="image-20200509122554545" tabindex="0" loading="lazy"><figcaption>image-20200509122554545</figcaption></figure><p>Docker的思想来自于集装箱，集装箱解决了什么问题？在一艘大船上，可以把货物规整的摆放起来。并且各种各样的货物被集装箱标准化了，集装箱和集装箱之间不会互相影响。那么我就不需要专门运送水果的船和专门运送化学品的船了。只要这些货物在集装箱里封装的好好的，那我就可以用一艘大船把他们都运走。</p><p>docker就是类似的理念。</p><blockquote><p>历史</p></blockquote><p>2010年，几个搞IT的年轻人，在美国旧金山成立了一家名叫“dotCloud”的公司。</p><p>这家公司主要提供基于PaaS的云计算技术服务。具体来说，是和LXC有关的容器技术。</p><p>后来，dotCloud公司将自己的容器技术进行了简化和标准化，并命名为——<strong>Docker</strong>。</p><p>Docker技术诞生之后，并没有引起行业的关注。而dotCloud公司，作为一家小型创业企业，在激烈的竞争之下，也步履维艰。</p><p>正当他们快要坚持不下去的时候，脑子里蹦出了“开源”的想法。</p><p>什么是“开源”？开源，就是开放源代码。也就是将原来内部保密的程序源代码开放给所有人，然后让大家一起参与进来，贡献代码和意见。</p><p>有的软件是一开始就开源的。也有的软件，是混不下去，创造者又不想放弃，所以选择开源。自己养不活，就吃“百家饭”嘛。</p><p>2013年3月，dotCloud公司的创始人之一，Docker之父，28岁的<strong>Solomon Hykes</strong>正式决定，将Docker项目开源。</p><p>不开则已，一开惊人。</p><p>越来越多的IT工程师发现了Docker的优点，然后蜂拥而至，加入Docker开源社区。</p><p>Docker的人气迅速攀升，速度之快，令人瞠目结舌。</p><p>开源当月，Docker 0.1 版本发布。此后的每一个月，Docker都会发布一个版本。到2014年6月9日，Docker 1.0 版本正式发布。</p><p>此时的Docker，已经成为行业里人气最火爆的开源技术，没有之一。甚至像Google、微软、Amazon、VMware这样的巨头，都对它青睐有加，表示将全力支持。</p><p>Docker和容器技术为什么会这么火爆？说白了，就是因为它“轻”。</p><p>在容器技术之前，业界的网红是<strong>虚拟机</strong>。虚拟机技术的代表，是<strong>VMWare</strong>和<strong>OpenStack</strong>。</p><p>相信很多人都用过虚拟机。虚拟机，就是在你的操作系统里面，装一个软件，然后通过这个软件，再模拟一台甚至多台“子电脑”出来。</p><p>在“子电脑”里，你可以和正常电脑一样运行程序，例如开QQ。如果你愿意，你可以变出好几个“子电脑”，里面都开上QQ。“子电脑”和“子电脑”之间，是<strong>相互隔离</strong>的，互不影响。</p><p>虚拟机属于虚拟化技术。而Docker这样的容器技术，也是虚拟化技术，属于<strong>轻量级的虚拟化</strong>。</p><p>虚拟机虽然可以隔离出很多“子电脑”，但占用空间更大，启动更慢，虚拟机软件可能还要花钱（例如VMWare）。</p><p>而容器技术恰好没有这些缺点。它不需要虚拟出整个操作系统，只需要虚拟一个小规模的环境（类似“沙箱”）。</p><p>它启动时间很快，几秒钟就能完成。而且，它对资源的利用率很高（一台主机可以同时运行几千个Docker容器）。此外，它占的空间很小，虚拟机一般要几GB到几十GB的空间，而容器只需要MB级甚至KB级。</p><p>正因为如此，容器技术受到了热烈的欢迎和追捧，发展迅速。</p><blockquote><p>docker 理念</p></blockquote><p>Docker是基于Go语言实现的云开源项目。</p><p>Docker的主要目标是“Build，Ship and Run Any App , Anywhere”，也就是通过对应用组件的封装、分发、部署、运行等生命周期的管理，使用户的APP（可以是一个WEB应用或数据库应用等等）及其运行环境能够做到“一次封装，到处运行”。</p><p>Linux 容器技术的出现就解决了这样一个问题，而 Docker 就是在它的基础上发展过来的。将应用运行在 Docker 容器上面，而 Docker 容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作。</p><h2 id="docker能干嘛" tabindex="-1"><a class="header-anchor" href="#docker能干嘛"><span>Docker能干嘛</span></a></h2><blockquote><p>之前的虚拟机技术</p></blockquote><p>虚拟机（virtual machine）就是带环境安装的一种解决方案。</p><p>它可以在一种操作系统里面运行另一种操作系统，比如在Windows 系统里面运行Linux 系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，操作系统和硬件三者之间的逻辑不变。</p><figure><img src="/assets/image-20200116172523291-DElu1cbj.png" alt="image-20200116172523291" tabindex="0" loading="lazy"><figcaption>image-20200116172523291</figcaption></figure><p><strong>虚拟机的缺点：</strong></p><p>1、资源占用多</p><p>2、冗余步骤多</p><p>3 、启动慢</p><blockquote><p>容器虚拟化技术</p></blockquote><p>由于前面虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。</p><p>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。</p><figure><img src="/assets/image-20200116172807060-DpVXrePI.png" alt="image-20200116172807060" tabindex="0" loading="lazy"><figcaption>image-20200116172807060</figcaption></figure><p>比较了 Docker 和传统虚拟化方式的不同之处：</p><ul><li>传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；</li><li>而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。</li><li>每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资源。</li></ul><blockquote><p>开发/运维（DevOps）</p></blockquote><p><strong>更快速的应用交付和部署：</strong></p><p>传统的应用开发完成后，需要提供一堆安装程序和配置说明文档，安装部署后需根据配置文档进行繁杂的配置才能正常运行。Docker化之后只需要交付少量容器镜像文件，在正式生产环境加载镜像并运行即可，应用安装配置在镜像里已经内置好，大大节省部署配置和测试验证时间。</p><p><strong>更便捷的升级和扩缩容：</strong></p><p>随着微服务架构和Docker的发展，大量的应用会通过微服务方式架构，应用的开发构建将变成搭乐高积木一样，每个Docker容器将变成一块“积木”，应用的升级将变得非常容易。当现有的容器不足以支撑业务处理时，可通过镜像运行新的容器进行快速扩容，使应用系统的扩容从原先的天级变成分钟级甚至秒级。</p><p><strong>更简单的系统运维：</strong></p><p>应用容器化运行后，生产环境运行的应用可与开发、测试环境的应用高度一致，容器会将应用程序相关的环境和状态完全封装起来，不会因为底层基础架构和操作系统的不一致性给应用带来影响，产生新的BUG。当出现程序异常时，也可以通过测试环境的相同容器进行快速定位和修复。</p><p><strong>更高效的计算资源利用：</strong></p><p>Docker是内核级虚拟化，其不像传统的虚拟化技术一样需要额外的Hypervisor [管理程序] 支持，所以在一台物理机上可以运行很多个容器实例，可大大提升物理服务器的CPU和内存的利用率。</p><blockquote><p>学习途径</p></blockquote><p>Docker官网：http://www.docker.com</p><p>Docker中文网站：https://www.docker-cn.com</p><p>Docker Hub官网：https://hub.docker.com （仓库）</p><p>还是我那句话，只要学不死，就往死里学！</p><p>我还是坚信，真正好的教学就是授人以渔，避免大家少走弯路，让所有人能有一个公平的学习环境。我的所有课程都是免费的，大家千万不要上当受骗哦，ok，让我们学习来！</p><h1 id="docker安装" tabindex="-1"><a class="header-anchor" href="#docker安装"><span>Docker安装</span></a></h1><h2 id="docker的基本组成" tabindex="-1"><a class="header-anchor" href="#docker的基本组成"><span>Docker的基本组成</span></a></h2><p><strong>Docker的架构图</strong></p><figure><img src="/assets/image-20200116185657945-B6hpz2FL.png" alt="image-20200116185657945" tabindex="0" loading="lazy"><figcaption>image-20200116185657945</figcaption></figure><p><strong>镜像（image）：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span>Docker 镜像（Image）就是一个只读的模板。镜像可以用来创建 Docker 容器，一个镜像可以创建很多容器。 就好似 Java 中的 类和对象，类就是镜像，容器就是对象！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>容器（container）：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>它可以被启动、开始、停止、删除。每个容器都是相互隔离的，保证安全的平台。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>可以把容器看做是一个简易版的 Linux 环境（包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序。。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写的。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>仓库（repository）：</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span>仓库（Repository）是集中存放镜像文件的场所。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>仓库(Repository)和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓库，每个仓库中又包含了多个镜像，每个镜像有不同的标签（tag）。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>仓库分为公开仓库（Public）和私有仓库（Private）两种形式。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>最大的公开仓库是 Docker Hub(https://hub.docker.com/)，存放了数量庞大的镜像供用户下载。</span></span>
<span class="line"><span>国内的公开仓库包括阿里云 、网易云 等</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>小结：</strong></p><p>需要正确的理解仓储/镜像/容器这几个概念 :</p><ul><li><p>Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个可交付的运行环境，这个打包好的运行环境就似乎 image镜像文件。只有通过这个镜像文件才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p></li><li><p>image 文件生成的容器实例，本身也是一个文件，称为镜像文件。</p></li><li><p>一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器</p></li><li><p>至于仓库，就是放了一堆镜像的地方，我们可以把镜像发布到仓库中，需要的时候从仓库中拉下来就可以了。</p></li></ul><h2 id="环境说明" tabindex="-1"><a class="header-anchor" href="#环境说明"><span>环境说明</span></a></h2><p>我们使用的是 CentOS 7 (64-bit)</p><p>目前，CentOS 仅发行版本中的内核支持 Docker。</p><p>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。</p><p><strong>查看自己的内核：</strong></p><p><code>uname -r</code>命令用于打印当前系统相关信息（内核版本号、硬件架构、主机名称和操作系统类型等）。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# uname -r</span></span>
<span class="line"><span style="color:#795E26;">3.10.0-1062.12.1.el7.x86_64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看版本信息：</strong></p><p><code>cat /etc/os-release</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# cat /etc/os-release</span></span>
<span class="line"><span style="color:#001080;">NAME</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;CentOS Linux&quot;</span></span>
<span class="line"><span style="color:#001080;">VERSION</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;7 (Core)&quot;</span></span>
<span class="line"><span style="color:#001080;">ID</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;centos&quot;</span></span>
<span class="line"><span style="color:#001080;">ID_LIKE</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;rhel fedora&quot;</span></span>
<span class="line"><span style="color:#001080;">VERSION_ID</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;7&quot;</span></span>
<span class="line"><span style="color:#001080;">PRETTY_NAME</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;CentOS Linux 7 (Core)&quot;</span></span>
<span class="line"><span style="color:#001080;">ANSI_COLOR</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;0;31&quot;</span></span>
<span class="line"><span style="color:#001080;">CPE_NAME</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;cpe:/o:centos:centos:7&quot;</span></span>
<span class="line"><span style="color:#001080;">HOME_URL</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;https://www.centos.org/&quot;</span></span>
<span class="line"><span style="color:#001080;">BUG_REPORT_URL</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;https://bugs.centos.org/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#001080;">CENTOS_MANTISBT_PROJECT</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;CentOS-7&quot;</span></span>
<span class="line"><span style="color:#001080;">CENTOS_MANTISBT_PROJECT_VERSION</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;7&quot;</span></span>
<span class="line"><span style="color:#001080;">REDHAT_SUPPORT_PRODUCT</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;centos&quot;</span></span>
<span class="line"><span style="color:#001080;">REDHAT_SUPPORT_PRODUCT_VERSION</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;7&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装步骤" tabindex="-1"><a class="header-anchor" href="#安装步骤"><span>安装步骤</span></a></h2><p>1、官网安装参考手册：https://docs.docker.com/engine/install/centos/</p><p>2、确定你是CentOS7及以上版本，我们已经做过了</p><p>3、yum安装gcc相关环境（需要确保 虚拟机可以上外网 ）</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> gcc</span></span>
<span class="line"><span style="color:#795E26;">yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> gcc-c++</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、卸载旧版本</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">yum</span><span style="color:#A31515;"> remove</span><span style="color:#A31515;"> docker</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-client</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-client-latest</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-common</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-latest</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-latest-logrotate</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-logrotate</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#A31515;">                  docker-engine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、安装需要的软件包</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">yum</span><span style="color:#A31515;"> install</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> yum-utils</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>6、设置阿里云Docker源</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 使用国内的</span></span>
<span class="line"><span style="color:#795E26;">yum-config-manager</span><span style="color:#0000FF;"> --add-repo</span><span style="color:#A31515;"> http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>7、更新yum软件包索引</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">yum</span><span style="color:#A31515;"> makecache</span><span style="color:#A31515;"> fast</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>8、安装 Docker CE（最新版)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">sudo</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> docker-ce</span><span style="color:#A31515;"> docker-ce-cli</span><span style="color:#A31515;"> containerd.io</span><span style="color:#A31515;"> docker-buildx-plugin</span><span style="color:#A31515;"> docker-compose-plugin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>9、启动 Docker</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">systemctl</span><span style="color:#A31515;"> start</span><span style="color:#A31515;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>10、测试命令</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#A31515;"> hello-world</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> images</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/assets/image-20200509132430134-BpV2en0r.png" alt="image-20200509132430134" tabindex="0" loading="lazy"><figcaption>image-20200509132430134</figcaption></figure><p>11、卸载</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">systemctl</span><span style="color:#A31515;"> stop</span><span style="color:#A31515;"> docker</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> remove</span><span style="color:#A31515;"> docker-ce</span><span style="color:#A31515;"> docker-ce-cli</span><span style="color:#A31515;"> containerd.io</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">rm</span><span style="color:#0000FF;"> -rf</span><span style="color:#A31515;"> /var/lib/docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="docker镜像阿里云镜像加速" tabindex="-1"><a class="header-anchor" href="#docker镜像阿里云镜像加速"><span>Docker镜像阿里云镜像加速</span></a></h2><p>1、介绍：<a href="https://www.aliyun.com/product/acr" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/product/acr</a></p><p>2、注册一个属于自己的阿里云账户(可复用淘宝账号)</p><p>3、进入管理控制台设置密码，开通</p><p>4、查看镜像加速器自己的</p><figure><img src="/assets/image-20200509132741809-BiKOy6xK.png" alt="image-20200509132741809" tabindex="0" loading="lazy"><figcaption>image-20200509132741809</figcaption></figure><p>5、配置镜像加速</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">sudo</span><span style="color:#A31515;"> mkdir</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> /etc/docker</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">sudo</span><span style="color:#A31515;"> tee</span><span style="color:#A31515;"> /etc/docker/daemon.json</span><span style="color:#000000;"> &lt;&lt;-</span><span style="color:#000000;">&#39;EOF&#39;</span></span>
<span class="line"><span style="color:#A31515;">{</span></span>
<span class="line"><span style="color:#A31515;">  &quot;registry-mirrors&quot;: [&quot;https://qiyb9988.mirror.aliyuncs.com&quot;]</span></span>
<span class="line"><span style="color:#A31515;">}</span></span>
<span class="line"><span style="color:#000000;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">sudo</span><span style="color:#A31515;"> systemctl</span><span style="color:#A31515;"> daemon-reload</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">sudo</span><span style="color:#A31515;"> systemctl</span><span style="color:#A31515;"> restart</span><span style="color:#A31515;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>测试 HelloWorld</p></blockquote><p>1、启动hello-world</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#A31515;"> hello-world</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>2、run干了什么？</p><figure><img src="/assets/image-20200509133007940-Cf9KfjjV.png" alt="image-20200509133007940" tabindex="0" loading="lazy"><figcaption>image-20200509133007940</figcaption></figure><h2 id="底层原理" tabindex="-1"><a class="header-anchor" href="#底层原理"><span>底层原理</span></a></h2><p><strong>Docker是怎么工作的</strong></p><p>Docker是一个Client-Server结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户端访问，守护进程从客户端接受命令并管理运行在主机上的容器。 容器，是一个运行时环境，就是我们前面说到的集装箱。</p><figure><img src="/assets/image-20200509133206490-ChYhugBH.png" alt="image-20200509133206490" tabindex="0" loading="lazy"><figcaption>image-20200509133206490</figcaption></figure><p><strong>为什么Docker比较 VM 快</strong></p><p>1、docker有着比虚拟机更少的抽象层。由亍docker不需要Hypervisor实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。</p><p>2、docker利用的是宿主机的内核,而不需要Guest OS。因此,当新建一个容器时,docker不需要和虚拟机一样重新加载一个操作系统内核。仍而避免引寻、加载操作系统内核返个比较费时费资源的过程,当新建一个虚拟机时,虚拟机软件需要加载Guest OS,返个新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了返个过程,因此新建一个docker容器只需要几秒钟。<img src="/assets/image-20200511153952746-DZevCOTz.png" alt="image-20200511153952746" loading="lazy"><img src="/assets/image-20200511154005658-Bf4N9Fwm.png" alt="image-20200511154005658" loading="lazy"></p><h1 id="docker常用命令" tabindex="-1"><a class="header-anchor" href="#docker常用命令"><span>Docker常用命令</span></a></h1><h2 id="帮助命令" tabindex="-1"><a class="header-anchor" href="#帮助命令"><span>帮助命令</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> version</span><span style="color:#008000;">   # 显示 Docker 版本信息。</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> info</span><span style="color:#008000;">      # 显示 Docker 系统信息，包括镜像和容器数。。</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#0000FF;"> --help</span><span style="color:#008000;">    # 帮助</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="镜像命令" tabindex="-1"><a class="header-anchor" href="#镜像命令"><span>镜像命令</span></a></h2><p><strong>docker images</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 列出本地主机上的镜像 </span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker images</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">          TAG</span><span style="color:#A31515;">                 IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">            CREATED</span><span style="color:#A31515;">             SIZE</span></span>
<span class="line"><span style="color:#795E26;">hello-world</span><span style="color:#A31515;">         latest</span><span style="color:#A31515;">              bf756fb1ae65</span><span style="color:#098658;">        4</span><span style="color:#A31515;"> months</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">        13.3kB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 解释</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">   镜像的仓库源</span></span>
<span class="line"><span style="color:#795E26;">TAG</span><span style="color:#A31515;">          镜像的标签</span></span>
<span class="line"><span style="color:#795E26;">IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">     镜像的ID</span></span>
<span class="line"><span style="color:#795E26;">CREATED</span><span style="color:#A31515;">      镜像创建时间</span></span>
<span class="line"><span style="color:#795E26;">SIZE</span><span style="color:#A31515;">         镜像大小</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 同一个仓库源可以有多个 TAG，代表这个仓库源的不同版本，我们使用REPOSITORY：TAG 定义不同的镜像，如果你不定义镜像的标签版本，docker将默认使用 lastest 镜像！</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 可选项</span></span>
<span class="line"><span style="color:#795E26;">-a：</span><span style="color:#A31515;">        列出本地所有镜像</span></span>
<span class="line"><span style="color:#795E26;">-q：</span><span style="color:#A31515;">        只显示镜像id</span></span>
<span class="line"><span style="color:#795E26;">--digests：</span><span style="color:#A31515;"> 显示镜像的摘要信息</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>docker search</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 搜索镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker search mysql</span></span>
<span class="line"><span style="color:#795E26;">NAME</span><span style="color:#A31515;">       DESCRIPTION</span><span style="color:#A31515;">                                     STARS</span><span style="color:#A31515;">               OFFICIAL</span><span style="color:#000000;">         </span></span>
<span class="line"><span style="color:#795E26;">mysql</span><span style="color:#A31515;">      MySQL</span><span style="color:#A31515;"> is</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> widely</span><span style="color:#A31515;"> used,</span><span style="color:#A31515;"> open-source</span><span style="color:#A31515;"> relation…</span><span style="color:#098658;">   9484</span><span style="color:#000000;">                [OK]                </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># docker search 某个镜像的名称   对应DockerHub仓库中的镜像</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 可选项</span></span>
<span class="line"><span style="color:#001080;">--filter</span><span style="color:#000000;">=</span><span style="color:#001080;">stars</span><span style="color:#000000;">=</span><span style="color:#A31515;">50</span><span style="color:#795E26;">  ：</span><span style="color:#A31515;"> 列出收藏数不小于指定值的镜像。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>docker pull</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 下载镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker pull mysql</span></span>
<span class="line"><span style="color:#795E26;">Using</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> tag:</span><span style="color:#A31515;"> latest</span><span style="color:#008000;"> # 不写tag，默认是latest</span></span>
<span class="line"><span style="color:#795E26;">latest:</span><span style="color:#A31515;"> Pulling</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> library/mysql</span></span>
<span class="line"><span style="color:#795E26;">54fec2fa59d0:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#008000;">   # 分层下载</span></span>
<span class="line"><span style="color:#795E26;">bcc6c6145912:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">951c3d959c9d:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">05de4d0e206e:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">319f0394ef42:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">d9185034607b:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">013a9c64dadc:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">42f3f7d10903:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">c4a3851d9207:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">82a1cc65c182:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">a0a6b01efa55:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">bca5ce71f9ea:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">Digest:</span><span style="color:#A31515;"> sha256:61a2a33f4b8b4bc93b7b6b9e65e64044aaec594809f818aeffbff69a893d1944</span><span style="color:#008000;">  # 签名</span></span>
<span class="line"><span style="color:#795E26;">Status:</span><span style="color:#A31515;"> Downloaded</span><span style="color:#A31515;"> newer</span><span style="color:#A31515;"> image</span><span style="color:#A31515;"> for</span><span style="color:#A31515;"> mysql:latest</span></span>
<span class="line"><span style="color:#795E26;">docker.io/library/mysql:latest</span><span style="color:#008000;">   # 真实位置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 指定版本下载</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker pull mysql:5.7</span></span>
<span class="line"><span style="color:#795E26;">....</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>docker rmi</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 删除镜像</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rmi</span><span style="color:#0000FF;"> -f</span><span style="color:#A31515;"> 镜像id</span><span style="color:#008000;">                         # 删除单个</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rmi</span><span style="color:#0000FF;"> -f</span><span style="color:#A31515;"> 镜像名:tag</span><span style="color:#A31515;"> 镜像名:tag</span><span style="color:#008000;">           # 删除多个</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rmi</span><span style="color:#0000FF;"> -f</span><span style="color:#000000;"> $(</span><span style="color:#795E26;">docker</span><span style="color:#A31515;"> images</span><span style="color:#0000FF;"> -qa</span><span style="color:#000000;">)          </span><span style="color:#008000;"># 删除全部</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="容器命令" tabindex="-1"><a class="header-anchor" href="#容器命令"><span>容器命令</span></a></h2><p><mark>说明</mark>：有镜像才能创建容器，我们这里使用 centos 的镜像来测试，就是虚拟一个 centos ！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> pull</span><span style="color:#A31515;"> centos</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>新建容器并启动</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#000000;"> [OPTIONS] IMAGE [COMMAND][ARG...]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 常用参数说明</span></span>
<span class="line"><span style="color:#001080;">--name</span><span style="color:#000000;">=</span><span style="color:#A31515;">&quot;Name&quot;</span><span style="color:#008000;">               # 给容器指定一个名字</span></span>
<span class="line"><span style="color:#795E26;">-d</span><span style="color:#008000;">                          # 后台方式运行容器，并返回容器的id！</span></span>
<span class="line"><span style="color:#795E26;">-i</span><span style="color:#008000;">                          # 以交互模式运行容器，通过和 -t 一起使用</span></span>
<span class="line"><span style="color:#795E26;">-t</span><span style="color:#008000;">                          # 给容器重新分配一个终端，通常和 -i 一起使用</span></span>
<span class="line"><span style="color:#795E26;">-P</span><span style="color:#008000;">                          # 随机端口映射（大写）</span></span>
<span class="line"><span style="color:#795E26;">-p</span><span style="color:#008000;">                          # 指定端口映射（小结），一般可以有四种写法</span></span>
<span class="line"><span style="color:#795E26;">	  ip:hostPort:containerPort</span></span>
<span class="line"><span style="color:#795E26;">	  ip::containerPort</span></span>
<span class="line"><span style="color:#795E26;">	  hostPort:containerPort</span><span style="color:#000000;"> (常用)</span></span>
<span class="line"><span style="color:#795E26;">	  containerPort</span></span>
<span class="line"><span style="color:#000000;">	  </span></span>
<span class="line"><span style="color:#008000;"># 测试</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker images</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">          TAG</span><span style="color:#A31515;">                 IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">            CREATED</span><span style="color:#A31515;">             SIZE</span></span>
<span class="line"><span style="color:#795E26;">centos</span><span style="color:#A31515;">              latest</span><span style="color:#A31515;">              470671670cac</span><span style="color:#098658;">        3</span><span style="color:#A31515;"> months</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">        237MB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 使用centos进行用交互模式启动容器，在容器内执行/bin/bash命令！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -it centos /bin/bash</span></span>
<span class="line"><span style="color:#000000;">[root@dc8f24dd06d0 /]# ls    </span><span style="color:#008000;"># 注意地址，已经切换到容器内部了！</span></span>
<span class="line"><span style="color:#795E26;">bin</span><span style="color:#A31515;">  etc</span><span style="color:#A31515;">   lib</span><span style="color:#A31515;">	  lost+found</span><span style="color:#A31515;">  mnt</span><span style="color:#A31515;">  proc</span><span style="color:#A31515;">  run</span><span style="color:#A31515;">   srv</span><span style="color:#A31515;">  tmp</span><span style="color:#A31515;">  var</span></span>
<span class="line"><span style="color:#795E26;">dev</span><span style="color:#A31515;">  home</span><span style="color:#A31515;">  lib64</span><span style="color:#A31515;">  media</span><span style="color:#A31515;">       opt</span><span style="color:#A31515;">  root</span><span style="color:#A31515;">  sbin</span><span style="color:#A31515;">  sys</span><span style="color:#A31515;">  usr</span></span>
<span class="line"><span style="color:#000000;">[root@dc8f24dd06d0 /]# exit  </span><span style="color:#008000;"># 使用 exit 退出容器</span></span>
<span class="line"><span style="color:#795E26;">exit</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]#</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>列出所有运行的容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#000000;"> [OPTIONS]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 常用参数说明</span></span>
<span class="line"><span style="color:#795E26;">-a</span><span style="color:#008000;">      # 列出当前所有正在运行的容器 + 历史运行过的容器</span></span>
<span class="line"><span style="color:#795E26;">-l</span><span style="color:#008000;">      # 显示最近创建的容器</span></span>
<span class="line"><span style="color:#001080;">-n</span><span style="color:#000000;">=</span><span style="color:#A31515;">?</span><span style="color:#008000;">    # 显示最近n个创建的容器</span></span>
<span class="line"><span style="color:#795E26;">-q</span><span style="color:#008000;">      # 静默模式，只显示容器编号。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>退出容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">exit</span><span style="color:#008000;">         # 容器停止退出</span></span>
<span class="line"><span style="color:#795E26;">ctrl+P+Q</span><span style="color:#008000;">     # 容器不停止退出</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>启动停止容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> start</span><span style="color:#000000;"> (容器id </span><span style="color:#A31515;">or</span><span style="color:#A31515;"> 容器名</span><span style="color:#000000;">)        </span><span style="color:#008000;"># 启动容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> restart</span><span style="color:#000000;"> (容器id </span><span style="color:#A31515;">or</span><span style="color:#A31515;"> 容器名</span><span style="color:#000000;">)      </span><span style="color:#008000;"># 重启容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> stop</span><span style="color:#000000;"> (容器id </span><span style="color:#A31515;">or</span><span style="color:#A31515;"> 容器名</span><span style="color:#000000;">)         </span><span style="color:#008000;"># 停止容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> kill</span><span style="color:#000000;"> (容器id </span><span style="color:#A31515;">or</span><span style="color:#A31515;"> 容器名</span><span style="color:#000000;">)         </span><span style="color:#008000;"># 强制停止容器</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>删除容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rm</span><span style="color:#A31515;"> 容器id</span><span style="color:#008000;">                  # 删除指定容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rm</span><span style="color:#0000FF;"> -f</span><span style="color:#000000;"> $(</span><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -a</span><span style="color:#0000FF;"> -q</span><span style="color:#000000;">)  </span><span style="color:#008000;"># 删除所有容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -a</span><span style="color:#0000FF;"> -q</span><span style="color:#000000;">|</span><span style="color:#795E26;">xargs</span><span style="color:#A31515;"> docker</span><span style="color:#A31515;"> rm</span><span style="color:#008000;">  # 删除所有容器</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="常用其他命令" tabindex="-1"><a class="header-anchor" href="#常用其他命令"><span>常用其他命令</span></a></h2><p><strong>后台启动容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#A31515;"> 容器名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 例子</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#A31515;"> centos</span><span style="color:#008000;"> # 启动centos，使用后台方式启动</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 问题： 使用docker ps 查看，发现容器已经退出了！</span></span>
<span class="line"><span style="color:#008000;"># 解释：Docker容器后台运行，就必须有一个前台进程，容器运行的命令如果不是那些一直挂起的命令，就会自动退出。</span></span>
<span class="line"><span style="color:#008000;"># 比如，你运行了nginx服务，但是docker前台没有运行应用，这种情况下，容器启动后，会立即自杀，因为他觉得没有程序了，所以最好的情况是，将你的应用使用前台进程的方式运行启动。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看日志</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> logs</span><span style="color:#0000FF;"> -f</span><span style="color:#0000FF;"> -t</span><span style="color:#0000FF;"> --tail</span><span style="color:#A31515;"> 容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 例子：我们启动 centos，并编写一段脚本来测试玩玩！最后查看日志</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d centos /bin/sh -c </span><span style="color:#A31515;">&quot;while true;do echo kuangshen;sleep 1;done&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#000000;">  </span></span>
<span class="line"><span style="color:#795E26;">c8530dbbe3b4</span><span style="color:#A31515;">        centos</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># -t 显示时间戳  </span></span>
<span class="line"><span style="color:#008000;"># -f 打印最新的日志 </span></span>
<span class="line"><span style="color:#008000;"># --tail 数字  显示多少条！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker logs -tf --tail 10 c8530dbbe3b4</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:40.656901941Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:41.658765018Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:42.661015375Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:43.662865628Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:44.664571547Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:45.666718583Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:46.668556725Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:47.670424699Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:48.672324512Z</span><span style="color:#A31515;"> kuangshen</span></span>
<span class="line"><span style="color:#795E26;">2020-05-11T08:46:49.674092766Z</span><span style="color:#A31515;"> kuangshen</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看容器中运行的进程信息，支持 ps 命令参数。</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> top</span><span style="color:#A31515;"> 容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker top c8530dbbe3b4</span></span>
<span class="line"><span style="color:#795E26;">UID</span><span style="color:#A31515;">     PID</span><span style="color:#A31515;">     PPID</span><span style="color:#A31515;">    C</span><span style="color:#A31515;">     STIME</span><span style="color:#A31515;">     TTY</span><span style="color:#A31515;">   TIME</span><span style="color:#A31515;">        CMD</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">    27437</span><span style="color:#098658;">   27421</span><span style="color:#098658;">   0</span><span style="color:#A31515;">     16:43</span><span style="color:#A31515;">    ?</span><span style="color:#A31515;">      00:00:00</span><span style="color:#A31515;">    /bin/sh</span><span style="color:#0000FF;"> -c</span><span style="color:#A31515;"> ....</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看容器/镜像的元数据</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> inspect</span><span style="color:#A31515;"> 容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker inspect c8530dbbe3b4</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#008000;">    	# 完整的id，有意思啊，这里上面的容器id，就是截取的这个id前几位！</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Id&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;c8530dbbe3b44a0c873f2566442df6543ed653c1319753e34b400efa05f77cf8&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Created&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;2020-05-11T08:43:45.096892382Z&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Path&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;/bin/sh&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Args&quot;</span><span style="color:#000000;">: [ </span></span>
<span class="line"><span style="color:#A31515;">            &quot;-c&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;while true;do echo kuangshen;sleep 1;done&quot;</span></span>
<span class="line"><span style="color:#000000;">        ],</span></span>
<span class="line"><span style="color:#008000;">        # 状态</span></span>
<span class="line"><span style="color:#A31515;">        &quot;State&quot;</span><span style="color:#000000;">: { </span></span>
<span class="line"><span style="color:#A31515;">            &quot;Status&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;running&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Running&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">true</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Paused&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Restarting&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;OOMKilled&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Dead&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Pid&quot;</span><span style="color:#000000;">: 27437,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;ExitCode&quot;</span><span style="color:#000000;">: 0,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Error&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;StartedAt&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;2020-05-11T08:43:45.324474622Z&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;FinishedAt&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;0001-01-01T00:00:00Z&quot;</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#000000;">     // ...........</span></span>
<span class="line"><span style="color:#000000;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>进入正在运行的容器</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令1</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> exec</span><span style="color:#0000FF;"> -it</span><span style="color:#A31515;"> 容器id</span><span style="color:#A31515;"> bashShell</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试1</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">               COMMAND</span><span style="color:#A31515;">                  CREATED</span><span style="color:#A31515;">             STATUS</span><span style="color:#A31515;">              PORTS</span><span style="color:#A31515;">               NAMES</span></span>
<span class="line"><span style="color:#795E26;">c8530dbbe3b4</span><span style="color:#A31515;">        centos</span><span style="color:#A31515;">              &quot;/bin/sh -c &#39;while t…&quot;</span><span style="color:#098658;">   12</span><span style="color:#A31515;"> minutes</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">      Up</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> minutes</span><span style="color:#A31515;">                           happy_chaum</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it c8530dbbe3b4 /bin/bash</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 /]# ps -ef</span></span>
<span class="line"><span style="color:#795E26;">UID</span><span style="color:#A31515;">        PID</span><span style="color:#A31515;">  PPID</span><span style="color:#A31515;">  C</span><span style="color:#A31515;"> STIME</span><span style="color:#A31515;"> TTY</span><span style="color:#A31515;">          TIME</span><span style="color:#A31515;"> CMD</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">         1</span><span style="color:#098658;">     0</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:43</span><span style="color:#A31515;"> ?</span><span style="color:#A31515;">        00:00:00</span><span style="color:#A31515;"> /bin/sh</span><span style="color:#0000FF;"> -c</span><span style="color:#A31515;"> while</span><span style="color:#0000FF;"> true</span><span style="color:#000000;">;</span><span style="color:#AF00DB;">do</span><span style="color:#000000;"> echo kuangshen;</span><span style="color:#795E26;">sleep</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       751</span><span style="color:#098658;">     0</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:56</span><span style="color:#A31515;"> pts/0</span><span style="color:#A31515;">    00:00:00</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       769</span><span style="color:#098658;">     1</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:56</span><span style="color:#A31515;"> ?</span><span style="color:#A31515;">        00:00:00</span><span style="color:#A31515;"> /usr/bin/coreutils</span><span style="color:#0000FF;"> --coreutils-prog-shebang=s</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       770</span><span style="color:#098658;">   751</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:56</span><span style="color:#A31515;"> pts/0</span><span style="color:#A31515;">    00:00:00</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -ef</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 命令2</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> attach</span><span style="color:#A31515;"> 容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试2</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it c8530dbbe3b4 /bin/bash</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 /]# ps -ef</span></span>
<span class="line"><span style="color:#795E26;">UID</span><span style="color:#A31515;">        PID</span><span style="color:#A31515;">  PPID</span><span style="color:#A31515;">  C</span><span style="color:#A31515;"> STIME</span><span style="color:#A31515;"> TTY</span><span style="color:#A31515;">          TIME</span><span style="color:#A31515;"> CMD</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">         1</span><span style="color:#098658;">     0</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:43</span><span style="color:#A31515;"> ?</span><span style="color:#A31515;">        00:00:00</span><span style="color:#A31515;"> /bin/sh</span><span style="color:#0000FF;"> -c</span><span style="color:#A31515;"> while</span><span style="color:#0000FF;"> true</span><span style="color:#000000;">;</span><span style="color:#AF00DB;">do</span><span style="color:#000000;"> echo kuangshen;</span><span style="color:#795E26;">sleep</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       856</span><span style="color:#098658;">     0</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:57</span><span style="color:#A31515;"> pts/0</span><span style="color:#A31515;">    00:00:00</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       874</span><span style="color:#098658;">     1</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:57</span><span style="color:#A31515;"> ?</span><span style="color:#A31515;">        00:00:00</span><span style="color:#A31515;"> /usr/bin/coreutils</span><span style="color:#0000FF;"> --coreutils-prog-shebang=s</span></span>
<span class="line"><span style="color:#795E26;">root</span><span style="color:#098658;">       875</span><span style="color:#098658;">   856</span><span style="color:#098658;">  0</span><span style="color:#A31515;"> 08:57</span><span style="color:#A31515;"> pts/0</span><span style="color:#A31515;">    00:00:00</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -ef</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 区别</span></span>
<span class="line"><span style="color:#008000;"># exec   是在容器中打开新的终端，并且可以启动新的进程</span></span>
<span class="line"><span style="color:#008000;"># attach 直接进入容器启动命令的终端，不会启动新的进程</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>从容器内拷贝文件到主机上</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> cp</span><span style="color:#A31515;"> 容器id:容器内路径</span><span style="color:#A31515;"> 目的主机路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试</span></span>
<span class="line"><span style="color:#008000;"># 容器内执行，创建一个文件测试</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 /]# cd /home</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 home]# touch f1</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 home]# ls</span></span>
<span class="line"><span style="color:#795E26;">f1</span></span>
<span class="line"><span style="color:#000000;">[root@c8530dbbe3b4 home]# exit </span></span>
<span class="line"><span style="color:#795E26;">exit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># linux复制查看，是否复制成功</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker cp c8530dbbe3b4:/home/f1 /home</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# cd /home</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# ls</span></span>
<span class="line"><span style="color:#795E26;">f1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结"><span>小结</span></a></h2><figure><img src="/assets/image-20200511170557675-BVq_CRNW.png" alt="image-20200511170557675" tabindex="0" loading="lazy"><figcaption>image-20200511170557675</figcaption></figure><p>常用命令</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">attach</span><span style="color:#A31515;">    Attach</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> running</span><span style="color:#A31515;"> container</span><span style="color:#008000;">                 # 当前 shell 下 attach 连接指定运行镜像</span></span>
<span class="line"><span style="color:#795E26;">build</span><span style="color:#A31515;">     Build</span><span style="color:#A31515;"> an</span><span style="color:#A31515;"> image</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> Dockerfile</span><span style="color:#008000;">              # 通过 Dockerfile 定制镜像</span></span>
<span class="line"><span style="color:#795E26;">commit</span><span style="color:#A31515;">    Create</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> new</span><span style="color:#A31515;"> image</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> changes</span><span style="color:#008000;">   # 提交当前容器为新的镜像</span></span>
<span class="line"><span style="color:#795E26;">cp</span><span style="color:#A31515;">        Copy</span><span style="color:#A31515;"> files/folders</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> the</span><span style="color:#A31515;"> containers</span><span style="color:#A31515;"> filesystem</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> the</span><span style="color:#A31515;"> host</span><span style="color:#A31515;"> path</span><span style="color:#000000;">   [[从容器中拷贝指定文件或者目录到宿主机中]]</span></span>
<span class="line"><span style="color:#795E26;">create</span><span style="color:#A31515;">    Create</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> new</span><span style="color:#A31515;"> container</span><span style="color:#008000;">                        # 创建一个新的容器，同 run，但不启动容器</span></span>
<span class="line"><span style="color:#795E26;">diff</span><span style="color:#A31515;">      Inspect</span><span style="color:#A31515;"> changes</span><span style="color:#A31515;"> on</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> container&#39;s filesystem   # 查看 docker 容器变化</span></span>
<span class="line"><span style="color:#A31515;">events    Get real time events from the server          # 从 docker 服务获取容器实时事件</span></span>
<span class="line"><span style="color:#A31515;">exec      Run a command in an existing container        # 在已存在的容器上运行命令</span></span>
<span class="line"><span style="color:#A31515;">export    Stream the contents of a container as a tar archive   # 导出容器的内容流作为一个 tar 归档文件[对应 import ]</span></span>
<span class="line"><span style="color:#A31515;">history   Show the history of an image                  # 展示一个镜像形成历史</span></span>
<span class="line"><span style="color:#A31515;">images    List images                                   # 列出系统当前镜像</span></span>
<span class="line"><span style="color:#A31515;">import    Create a new filesystem image from the contents of a tarball # 从tar包中的内容创建一个新的文件系统映像[对应export]</span></span>
<span class="line"><span style="color:#A31515;">info      Display system-wide information               # 显示系统相关信息</span></span>
<span class="line"><span style="color:#A31515;">inspect   Return low-level information on a container   # 查看容器详细信息</span></span>
<span class="line"><span style="color:#A31515;">kill      Kill a running container                      # kill 指定 docker 容器</span></span>
<span class="line"><span style="color:#A31515;">load      Load an image from a tar archive              # 从一个 tar 包中加载一个镜像[对应 save]</span></span>
<span class="line"><span style="color:#A31515;">login     Register or Login to the docker registry server    # 注册或者登陆一个 docker 源服务器</span></span>
<span class="line"><span style="color:#A31515;">logout    Log out from a Docker registry server          # 从当前 Docker registry 退出</span></span>
<span class="line"><span style="color:#A31515;">logs      Fetch the logs of a container                 # 输出当前容器日志信息</span></span>
<span class="line"><span style="color:#A31515;">port      Lookup the public-facing port which is NAT-ed to PRIVATE_PORT    # 查看映射端口对应的容器内部源端口</span></span>
<span class="line"><span style="color:#A31515;">pause     Pause all processes within a container        # 暂停容器</span></span>
<span class="line"><span style="color:#A31515;">ps        List containers                               # 列出容器列表</span></span>
<span class="line"><span style="color:#A31515;">pull      Pull an image or a repository from the docker registry server   # 从docker镜像源服务器拉取指定镜像或者库镜像</span></span>
<span class="line"><span style="color:#A31515;">push      Push an image or a repository to the docker registry server    # 推送指定镜像或者库镜像至docker源服务器</span></span>
<span class="line"><span style="color:#A31515;">restart   Restart a running container                   # 重启运行的容器</span></span>
<span class="line"><span style="color:#A31515;">rm        Remove one or more containers                 # 移除一个或者多个容器</span></span>
<span class="line"><span style="color:#A31515;">rmi       Remove one or more images             # 移除一个或多个镜像[无容器使用该镜像才可删除，否则需删除相关容器才可继续或 -f 强制删除]</span></span>
<span class="line"><span style="color:#A31515;">run       Run a command in a new container              # 创建一个新的容器并运行一个命令</span></span>
<span class="line"><span style="color:#A31515;">save      Save an image to a tar archive                # 保存一个镜像为一个 tar 包[对应 load]</span></span>
<span class="line"><span style="color:#A31515;">search    Search for an image on the Docker Hub         # 在 docker hub 中搜索镜像</span></span>
<span class="line"><span style="color:#A31515;">start     Start a stopped containers                    # 启动容器</span></span>
<span class="line"><span style="color:#A31515;">stop      Stop a running containers                     # 停止容器</span></span>
<span class="line"><span style="color:#A31515;">tag       Tag an image into a repository                # 给源中镜像打标签</span></span>
<span class="line"><span style="color:#A31515;">top       Lookup the running processes of a container   # 查看容器中运行的进程信息</span></span>
<span class="line"><span style="color:#A31515;">unpause   Unpause a paused container                    # 取消暂停容器</span></span>
<span class="line"><span style="color:#A31515;">version   Show the docker version information           # 查看 docker 版本号</span></span>
<span class="line"><span style="color:#A31515;">wait      Block until a container stops, then print its exit code   # 截取容器停止时的退出状态值</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="作业练习" tabindex="-1"><a class="header-anchor" href="#作业练习"><span>作业练习</span></a></h2><blockquote><p>使用Docker 安装 Nginx</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、搜索镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker search nginx</span></span>
<span class="line"><span style="color:#795E26;">NAME</span><span style="color:#A31515;">       DESCRIPTION</span><span style="color:#A31515;">                  STARS</span><span style="color:#A31515;">               OFFICIAL</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">nginx</span><span style="color:#A31515;">     Official</span><span style="color:#A31515;"> build</span><span style="color:#A31515;"> of</span><span style="color:#A31515;"> Nginx.</span><span style="color:#098658;">      13159</span><span style="color:#000000;">               [OK]                </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、拉取镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker pull nginx</span></span>
<span class="line"><span style="color:#795E26;">Using</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> tag:</span><span style="color:#A31515;"> latest</span></span>
<span class="line"><span style="color:#795E26;">latest:</span><span style="color:#A31515;"> Pulling</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> library/nginx</span></span>
<span class="line"><span style="color:#795E26;">54fec2fa59d0:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">4ede6f09aefe:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">f9dc69acb465:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">Digest:</span><span style="color:#A31515;"> sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12</span></span>
<span class="line"><span style="color:#795E26;">Status:</span><span style="color:#A31515;"> Downloaded</span><span style="color:#A31515;"> newer</span><span style="color:#A31515;"> image</span><span style="color:#A31515;"> for</span><span style="color:#A31515;"> nginx:latest</span></span>
<span class="line"><span style="color:#795E26;">docker.io/library/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、启动容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker images</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">          TAG</span><span style="color:#A31515;">                 IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">            CREATED</span><span style="color:#A31515;">             SIZE</span></span>
<span class="line"><span style="color:#795E26;">diytomcat</span><span style="color:#A31515;">           latest</span><span style="color:#A31515;">              ffdf6529937d</span><span style="color:#098658;">        3</span><span style="color:#A31515;"> hours</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">         636MB</span></span>
<span class="line"><span style="color:#795E26;">nginx</span><span style="color:#A31515;">               latest</span><span style="color:#A31515;">              602e111c06b6</span><span style="color:#098658;">        2</span><span style="color:#A31515;"> weeks</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">         127MB</span></span>
<span class="line"><span style="color:#795E26;">centos</span><span style="color:#A31515;">              latest</span><span style="color:#A31515;">              470671670cac</span><span style="color:#098658;">        3</span><span style="color:#A31515;"> months</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">        237MB</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d --name mynginx -p 3500:80 nginx</span></span>
<span class="line"><span style="color:#795E26;">a95d5f2f057fc609082cfa0de906bd690f95c43a26d38420d081f0e255b232ec</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">      PORTS</span><span style="color:#A31515;">                  NAMES</span></span>
<span class="line"><span style="color:#795E26;">a95d5f2f057f</span><span style="color:#A31515;">        nginx</span><span style="color:#A31515;">      0.0.0.0:3500</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">80/tcp</span><span style="color:#A31515;">   mynginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、测试访问</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# curl localhost:3500</span></span>
<span class="line"><span style="color:#000000;">&lt;html&gt;</span></span>
<span class="line"><span style="color:#000000;">    &lt;</span><span style="color:#795E26;">title</span><span style="color:#000000;">&gt;</span><span style="color:#A31515;">Welcome</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> nginx!</span><span style="color:#000000;">&lt;</span><span style="color:#A31515;">/titl</span><span style="color:#000000;">e&gt;  </span><span style="color:#008000;"># ok</span></span>
<span class="line"><span style="color:#795E26;">    ....</span></span>
<span class="line"><span style="color:#000000;">&lt;/html&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 5、进入容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it mynginx /bin/bash</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/#</span><span style="color:#A31515;"> whereis</span><span style="color:#A31515;"> nginx</span><span style="color:#008000;">  # 寻找nginx</span></span>
<span class="line"><span style="color:#795E26;">nginx:</span><span style="color:#A31515;"> /usr/sbin/nginx</span><span style="color:#A31515;"> /usr/lib/nginx</span><span style="color:#A31515;"> /etc/nginx</span><span style="color:#A31515;"> /usr/share/nginx</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/#</span><span style="color:#A31515;"> cd</span><span style="color:#A31515;"> /usr/share/nginx</span><span style="color:#008000;">   # nginx 的路径</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/usr/share/nginx#</span><span style="color:#A31515;"> ls</span></span>
<span class="line"><span style="color:#795E26;">html</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/usr/share/nginx#</span><span style="color:#A31515;"> cd</span><span style="color:#A31515;"> html</span><span style="color:#008000;">  # 首页的位置</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/usr/share/nginx/html#</span><span style="color:#A31515;"> ls</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">50x.html</span><span style="color:#A31515;">  index.html</span></span>
<span class="line"><span style="color:#795E26;">root@a95d5f2f057f:/usr/share/nginx/html#</span><span style="color:#A31515;"> cat</span><span style="color:#A31515;"> index.html</span></span>
<span class="line"><span style="color:#000000;">&lt;!</span><span style="color:#795E26;">DOCTYPE</span><span style="color:#A31515;"> htm</span><span style="color:#000000;">l&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;html&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;head&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;style&gt;</span></span>
<span class="line"><span style="color:#795E26;">    body</span><span style="color:#A31515;"> {</span></span>
<span class="line"><span style="color:#795E26;">        width:</span><span style="color:#A31515;"> 35em</span><span style="color:#000000;">;</span></span>
<span class="line"><span style="color:#795E26;">        margin:</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> auto</span><span style="color:#000000;">;</span></span>
<span class="line"><span style="color:#795E26;">        font-family:</span><span style="color:#A31515;"> Tahoma,</span><span style="color:#A31515;"> Verdana,</span><span style="color:#A31515;"> Arial,</span><span style="color:#A31515;"> sans-serif</span><span style="color:#000000;">;</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">&lt;/style&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;/head&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;body&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span></span>
<span class="line"><span style="color:#000000;">&lt;/html&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>使用docker安装 tomcat</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 官方文档解释</span></span>
<span class="line"><span style="color:#008000;"># -it ：交互模式</span></span>
<span class="line"><span style="color:#008000;"># --rm：容器启动成功并退出以后容器就自动移除，一般在测试情况下使用！</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -it</span><span style="color:#0000FF;"> --rm</span><span style="color:#A31515;"> tomcat:9.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 1、下载tomcat镜像</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> pull</span><span style="color:#A31515;"> tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、启动</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8080:8080</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> tomcat9</span><span style="color:#A31515;"> tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、进入tomcat</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> exec</span><span style="color:#0000FF;"> -it</span><span style="color:#A31515;"> tomcat9</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、思考：我们以后要部署项目，还需要进入容器中，是不是十分麻烦，要是有一种技术，可以将容器内和我们Linux进行映射挂载就好了？我们后面会将数据卷技术来进行挂载操作，也是一个核心内容，这里大家先听听名词就好，我们很快就会讲到！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>使用docker 部署 es + kibana</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 我们启动es这种容器需要考虑几个问题</span></span>
<span class="line"><span style="color:#795E26;">1、端口暴露问题</span><span style="color:#A31515;"> 9200、9300</span></span>
<span class="line"><span style="color:#795E26;">2、数据卷的挂载问题</span><span style="color:#A31515;"> data、plugins、conf</span></span>
<span class="line"><span style="color:#795E26;">3、吃内存</span><span style="color:#A31515;">  -</span><span style="color:#A31515;"> &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 扩展命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> stats</span><span style="color:#A31515;"> 容器id</span><span style="color:#008000;">    # 查看容器的cpu内存和网络状态</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 1、启动es测试</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> elasticsearch</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 9200:9200</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 9300:9300</span><span style="color:#0000FF;"> -e</span><span style="color:#A31515;"> &quot;discovery.type=single-node&quot;</span><span style="color:#A31515;"> elasticsearch:7.6.2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、启动之后很卡，使用 docker stats 容器id 查看下cpu状态 ，发现占用的很大</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        NAME</span><span style="color:#A31515;">                CPU</span><span style="color:#A31515;"> %</span><span style="color:#A31515;">               MEM</span><span style="color:#A31515;"> USAGE</span><span style="color:#A31515;"> /</span><span style="color:#A31515;"> LIMIT</span><span style="color:#A31515;">     MEM</span><span style="color:#A31515;"> %</span><span style="color:#000000;">          </span></span>
<span class="line"><span style="color:#795E26;">249ae46da625</span><span style="color:#A31515;">        elasticsearch</span><span style="color:#A31515;">       0.00%</span><span style="color:#A31515;">               1.036GiB</span><span style="color:#A31515;"> /</span><span style="color:#A31515;"> 1.716GiB</span><span style="color:#A31515;">   60.37%</span><span style="color:#000000;">    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、测试访问</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# curl localhost:9200</span></span>
<span class="line"><span style="color:#000000;">{</span></span>
<span class="line"><span style="color:#795E26;">  &quot;name&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;249ae46da625&quot;,</span></span>
<span class="line"><span style="color:#795E26;">  &quot;cluster_name&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;docker-cluster&quot;,</span></span>
<span class="line"><span style="color:#795E26;">  &quot;cluster_uuid&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;_Ho_i4fOTUesNc_II35sSA&quot;,</span></span>
<span class="line"><span style="color:#795E26;">  &quot;version&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> {</span></span>
<span class="line"><span style="color:#795E26;">    &quot;number&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;7.6.2&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;build_flavor&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;default&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;build_type&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;docker&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;build_hash&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;build_date&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;2020-03-26T06:34:37.794943Z&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;build_snapshot&quot;</span><span style="color:#A31515;"> :</span><span style="color:#0000FF;"> false</span><span style="color:#A31515;">,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;lucene_version&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;8.4.0&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;minimum_wire_compatibility_version&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;6.8.0&quot;,</span></span>
<span class="line"><span style="color:#795E26;">    &quot;minimum_index_compatibility_version&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;6.0.0-beta1&quot;</span></span>
<span class="line"><span style="color:#000000;">  },</span></span>
<span class="line"><span style="color:#795E26;">  &quot;tagline&quot;</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> &quot;You Know, for Search&quot;</span></span>
<span class="line"><span style="color:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、增加上内存限制启动</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> elasticsearch</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 9200:9200</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 9300:9300</span><span style="color:#0000FF;"> -e</span><span style="color:#A31515;"> &quot;discovery.type=single-node&quot;</span><span style="color:#0000FF;"> -e</span><span style="color:#A31515;"> ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot;</span><span style="color:#A31515;"> elasticsearch:7.6.2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 5、启动之后，使用 docker stats  查看下cpu状态 </span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        NAME</span><span style="color:#A31515;">                CPU</span><span style="color:#A31515;"> %</span><span style="color:#A31515;">               MEM</span><span style="color:#A31515;"> USAGE</span><span style="color:#A31515;"> /</span><span style="color:#A31515;"> LIMIT</span><span style="color:#A31515;">     MEM</span><span style="color:#A31515;"> %</span><span style="color:#000000;">   </span></span>
<span class="line"><span style="color:#795E26;">d2860684e7e4</span><span style="color:#A31515;">        elasticsearch</span><span style="color:#A31515;">       0.24%</span><span style="color:#A31515;">               358.3MiB</span><span style="color:#A31515;"> /</span><span style="color:#A31515;"> 1.716GiB</span><span style="color:#A31515;">   20.40%</span><span style="color:#000000;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 6、测试访问，效果一样，ok！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# curl localhost:9200</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 思考：如果我们要使用 kibana , 如果配置连接上我们的es呢？网络该如何配置呢？</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/assets/image-20200512171715752-Qa5uoW2q.png" alt="image-20200512171715752" tabindex="0" loading="lazy"><figcaption>image-20200512171715752</figcaption></figure><h2 id="可视化" tabindex="-1"><a class="header-anchor" href="#可视化"><span>可视化</span></a></h2><ul><li>Portainer（先用这个）</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8088:9000</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">--restart=always </span><span style="color:#0000FF;">-v</span><span style="color:#A31515;"> /var/run/docker.sock:/var/run/docker.sock</span><span style="color:#0000FF;"> --privileged=true</span><span style="color:#A31515;"> portainer/portainer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Rancher（CI/CD再用这个）</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[[安装rancher-server]]</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> rancher-server</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8000:8080</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /etc/localtime:/etc/localtime:ro</span><span style="color:#0000FF;">  -d</span><span style="color:#A31515;">  rancher/server</span></span>
<span class="line"><span style="color:#000000;">[[安装agent]]</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> --rm</span><span style="color:#0000FF;"> --privileged</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /var/run/docker.sock:/var/run/docker.sock</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /var/lib/rancher:/var/lib/rancher</span><span style="color:#A31515;"> rancher/agent:v1.2.11</span><span style="color:#A31515;"> http://39.101.191.131:8000/v1/scripts/D3DBD43F263109BB881F:1577750400000:7M0yBzCw4XSxJklD7TpysYIpI</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>介绍：</strong></p><p>Portainer是Docker的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷的基本操作（包括上传下载镜像，创建容器等操作）、事件日志显示、容器控制台操作、Swarm集群和服务等集中管理和操作、登录用户管理和控制等功能。功能十分全面，基本能满足中小型单位对容器管理的全部需求。</p><p>如果仅有一个docker宿主机，则可使用单机版运行，Portainer单机版运行十分简单，只需要一条语句即可启动容器，来管理该机器上的docker镜像、容器等数据。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8088:9000</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">--restart=always </span><span style="color:#0000FF;">-v</span><span style="color:#A31515;"> /var/run/docker.sock:/var/run/docker.sock</span><span style="color:#0000FF;"> --privileged=true</span><span style="color:#A31515;"> portainer/portainer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>访问方式：http://IP:8088</p><p>首次登陆需要注册用户，给admin用户设置密码：</p><figure><img src="/assets/image-20200512214311228-DgSxwjzS.png" alt="image-20200512214311228" tabindex="0" loading="lazy"><figcaption>image-20200512214311228</figcaption></figure><p>单机版这里选择local即可，选择完毕，点击Connect即可连接到本地docker：</p><figure><img src="/assets/image-20200512214343016-BUJaVDCb.png" alt="image-20200512214343016" tabindex="0" loading="lazy"><figcaption>image-20200512214343016</figcaption></figure><p>登录成功！</p><figure><img src="/assets/image-20200512214533001-_guD5QZt.png" alt="image-20200512214533001" tabindex="0" loading="lazy"><figcaption>image-20200512214533001</figcaption></figure><p>我们可以点击可视化界面来玩玩！</p><h1 id="docker镜像讲解" tabindex="-1"><a class="header-anchor" href="#docker镜像讲解"><span>Docker镜像讲解</span></a></h1><h2 id="镜像是什么" tabindex="-1"><a class="header-anchor" href="#镜像是什么"><span>镜像是什么</span></a></h2><p>镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p><h2 id="docker镜像加载原理" tabindex="-1"><a class="header-anchor" href="#docker镜像加载原理"><span>Docker镜像加载原理</span></a></h2><blockquote><p>UnionFS （联合文件系统）</p></blockquote><p>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p><p>特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</p><blockquote><p>Docker镜像加载原理</p></blockquote><p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。</p><p>bootfs(boot file system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</p><p>rootfs (root file system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p><figure><img src="/assets/1190037-20180203180342031-1621628053-CHOYbFDz.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>平时我们安装进虚拟机的CentOS都是好几个G，为什么Docker这里才200M？</p><figure><img src="/assets/image-20200511174246734-7KkXbpmQ.png" alt="image-20200511174246734" tabindex="0" loading="lazy"><figcaption>image-20200511174246734</figcaption></figure><p>对于一个精简的OS，rootfs 可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版, bootfs基本是一致的, rootfs会有差别, 因此不同的发行版可以公用bootfs。</p><h2 id="分层理解" tabindex="-1"><a class="header-anchor" href="#分层理解"><span>分层理解</span></a></h2><blockquote><p>分层的镜像</p></blockquote><p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层一层的在下载！</p><figure><img src="/assets/image-20200511174814562-DIZVQKog.png" alt="image-20200511174814562" tabindex="0" loading="lazy"><figcaption>image-20200511174814562</figcaption></figure><p>思考：为什么Docker镜像要采用这种分层的结构呢？</p><p>最大的好处，我觉得莫过于是资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。</p><p>查看镜像分层的方式可以通过 docker image inspect 命令！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen home]# docker image inspect redis:latest</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    // .....</span></span>
<span class="line"><span style="color:#A31515;">        &quot;RootFS&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Type&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;layers&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Layers&quot;</span><span style="color:#000000;">: [</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:c2adabaecedbda0af72b153c6499a0555f3a769d52370469d8f6bd6328af9b13&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:744315296a49be711c312dfa1b3a80516116f78c437367ff0bc678da1123e990&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:379ef5d5cb402a5538413d7285b21aa58a560882d15f1f553f7868dc4b66afa8&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:d00fd460effb7b066760f97447c071492d471c5176d05b8af1751806a1f905f8&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:4d0c196331523cfed7bf5bafd616ecb3855256838d850b6f3d5fba911f6c4123&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;sha256:98b4a6242af2536383425ba2d6de033a510e049d9ca07ff501b95052da76e894&quot;</span></span>
<span class="line"><span style="color:#000000;">            ]</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Metadata&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;LastTagTime&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;0001-01-01T00:00:00Z&quot;</span></span>
<span class="line"><span style="color:#000000;">        }</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>理解：</strong></p><p>所有的 Docker 镜像都起始于一个基础镜像层，当进行修改或增加新的内容时，就会在当前镜像层之上，创建新的镜像层。</p><p>举一个简单的例子，假如基于 Ubuntu Linux 16.04 创建一个新的镜像，这就是新镜像的第一层；如果在该镜像中添加 Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就会创建第三个镜像层。</p><p>该镜像当前已经包含 3 个镜像层，如下图所示（这只是一个用于演示的很简单的例子）。</p><figure><img src="/assets/4-1Z416164115364-DgWgK-jt.gif" alt="基于Ubuntu Linux 16.04创建镜像" tabindex="0" loading="lazy"><figcaption>基于Ubuntu Linux 16.04创建镜像</figcaption></figure><p>在添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重要。下图中举了一个简单的例子，每个镜像层包含 3 个文件，而镜像包含了来自两个镜像层的 6 个文件。</p><figure><img src="/assets/4-1Z41616413R94-_LqdmoDR.gif" alt="添加额外的镜像层后的镜像" tabindex="0" loading="lazy"><figcaption>添加额外的镜像层后的镜像</figcaption></figure><p>上图中的镜像层跟之前图中的略有区别，主要目的是便于展示文件。</p><p>下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有 6 个文件，这是因为最上层中的文件 7 是文件 5 的一个更新版本。</p><figure><img src="/assets/4-1Z416164203H1-9QJXYKEI.gif" alt="三层镜像" tabindex="0" loading="lazy"><figcaption>三层镜像</figcaption></figure><p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新镜像层添加到镜像当中。</p><p>Docker 通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统一的文件系统。</p><p>Linux 上可用的存储引擎有 AUFS、Overlay2、Device Mapper、Btrfs 以及 ZFS。顾名思义，每种存储引擎都基于 Linux 中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。</p><p>Docker 在 Windows 上仅支持 windowsfilter 一种存储引擎，该引擎基于 NTFS 文件系统之上实现了分层和 CoW[1]。</p><p>下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。</p><figure><img src="/assets/4-1Z4161642301E-C56shNGX.gif" alt="从系统角度看三层镜像" tabindex="0" loading="lazy"><figcaption>从系统角度看三层镜像</figcaption></figure><blockquote><p>特点</p></blockquote><p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部！</p><p>这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p><h2 id="镜像commit" tabindex="-1"><a class="header-anchor" href="#镜像commit"><span>镜像Commit</span></a></h2><p><strong>docker commit 从容器创建一个新的镜像。</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> commit</span><span style="color:#A31515;"> 提交容器副本使之成为一个新的镜像！</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 语法</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> commit</span><span style="color:#0000FF;"> -m=</span><span style="color:#A31515;">&quot;提交的描述信息&quot;</span><span style="color:#0000FF;"> -a=</span><span style="color:#A31515;">&quot;作者&quot;</span><span style="color:#A31515;"> 容器id</span><span style="color:#A31515;"> 要创建的目标镜像名:[标签名]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>测试</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、从Docker Hub 下载tomcat镜像到本地并运行  -it 交互终端 -p 端口映射</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -it</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8080:8080</span><span style="color:#A31515;"> tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 注意：坑爹：docker启动官方tomcat镜像的容器，发现404是因为使用了加速器，而加速器里的tomcat的webapps下没有root等文件！</span></span>
<span class="line"><span style="color:#008000;"># 下载tomcat官方镜像，就是这个镜像（阿里云里的tomcat的webapps下没有任何文件）</span></span>
<span class="line"><span style="color:#008000;"># 进入tomcat查看cd到webapps下发现全部空的，反而有个webapps.dist里有对应文件，cp -r 到webapps下！</span></span>
<span class="line"><span style="color:#795E26;">root@aba865b53114:/usr/local/tomcat#</span><span style="color:#A31515;"> cp</span><span style="color:#0000FF;"> -r</span><span style="color:#A31515;"> webapps.dist/</span><span style="color:#0000FF;">*</span><span style="color:#A31515;"> webapps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、删除上一步镜像产生的tomcat容器的文档</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#008000;">        # 查看容器id</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> exec</span><span style="color:#0000FF;"> -it</span><span style="color:#A31515;"> 容器id</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"><span style="color:#795E26;">/usr/local/tomcat</span><span style="color:#008000;"> # ce webapps/</span></span>
<span class="line"><span style="color:#795E26;">/usr/local/tomcat/webapps</span><span style="color:#008000;"> # ls -l  # 查看是否存在 docs文件夹</span></span>
<span class="line"><span style="color:#795E26;">/usr/local/tomcat/webapps</span><span style="color:#008000;"> # curl localhost:8080/docs/   # 可以看到 docs 返回的内容</span></span>
<span class="line"><span style="color:#795E26;">/usr/local/tomcat/webapps</span><span style="color:#008000;"> # rm -rf docs # 删除它</span></span>
<span class="line"><span style="color:#795E26;">/usr/local/tomcat/webapps</span><span style="color:#008000;"> # curl localhost:8080/docs/   # 再次访问返回404</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、当前运行的tomcat实例就是一个没有docs的容器，我们使用它为模板commit一个没有docs的tomcat新镜像， tomcat02</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -l</span><span style="color:#008000;">  # 查看容器的id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 注意：commit的时候，容器的名字不能有大写，否则报错：invalid reference format</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> commit</span><span style="color:#0000FF;"> -a=</span><span style="color:#A31515;">&quot;kuangshen&quot;</span><span style="color:#0000FF;"> -m=</span><span style="color:#A31515;">&quot;no tomcat docs&quot;</span><span style="color:#A31515;"> 1e98a2f815b0</span><span style="color:#A31515;"> tomcat02:1.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">sha256:cdccd4674f93ad34bf73d9db577a20f027a6d03fd1944dc0e628ee4bf17ec748</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen /]# docker images  </span><span style="color:#008000;"># 查看，我们自己提交的镜像已经OK了！</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">          TAG</span><span style="color:#A31515;">                 IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">            CREATED</span><span style="color:#A31515;">              SIZE</span></span>
<span class="line"><span style="color:#795E26;">tomcat02</span><span style="color:#098658;">            1.1</span><span style="color:#A31515;">                 cdccd4674f93</span><span style="color:#A31515;">        About</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> minute</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">   649MB</span></span>
<span class="line"><span style="color:#795E26;">redis</span><span style="color:#A31515;">               latest</span><span style="color:#A31515;">              f9b990972689</span><span style="color:#098658;">        9</span><span style="color:#A31515;"> days</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">           104MB</span></span>
<span class="line"><span style="color:#795E26;">tomcat</span><span style="color:#A31515;">              latest</span><span style="color:#A31515;">              927899a31456</span><span style="color:#098658;">        2</span><span style="color:#A31515;"> weeks</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">          647MB</span></span>
<span class="line"><span style="color:#795E26;">centos</span><span style="color:#A31515;">              latest</span><span style="color:#A31515;">              470671670cac</span><span style="color:#098658;">        3</span><span style="color:#A31515;"> months</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">         237MB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、这个时候，我们的镜像都是可以使用的，大家可以启动原来的tomcat，和我们新的tomcat02来测试看看！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -it -p 8080:8080 tomcat02:1.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 如果你想要保存你当前的状态，可以通过commit，来提交镜像，方便使用，类似于 VM 中的快照！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="容器数据卷" tabindex="-1"><a class="header-anchor" href="#容器数据卷"><span>容器数据卷</span></a></h1><h2 id="什么是容器数据卷" tabindex="-1"><a class="header-anchor" href="#什么是容器数据卷"><span>什么是容器数据卷</span></a></h2><p><strong>docker的理念回顾：</strong></p><p>将应用和运行的环境打包形成容器运行，运行可以伴随着容器，但是我们对于数据的要求，是希望能够持久化的！</p><p>就好比，你安装一个MySQL，结果你把容器删了，就相当于删库跑路了，这TM也太扯了吧！</p><p>所以我们希望容器之间有可能可以共享数据，Docker容器产生的数据，如果不通过docker commit 生成新的镜像，使得数据作为镜像的一部分保存下来，那么当容器删除后，数据自然也就没有了！这样是行不通的！</p><p>为了能保存数据在Docker中我们就可以使用卷！让数据挂载到我们本地！这样数据就不会因为容器删除而丢失了！</p><p><strong>作用：</strong></p><p>卷就是目录或者文件，存在一个或者多个容器中，由docker挂载到容器，但不属于联合文件系统，因此能够绕过 Union File System ， 提供一些用于持续存储或共享数据的特性：</p><p>卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂载的数据卷。</p><p><strong>特点：</strong></p><p>1、数据卷可在容器之间共享或重用数据</p><p>2、卷中的更改可以直接生效</p><p>3、数据卷中的更改不会包含在镜像的更新中</p><p>4、数据卷的生命周期一直持续到没有容器使用它为止</p><p><strong>所以：总结一句话： 就是容器的持久化，以及容器间的继承和数据共享！</strong></p><h2 id="使用数据卷" tabindex="-1"><a class="header-anchor" href="#使用数据卷"><span>使用数据卷</span></a></h2><blockquote><p>方式一：容器中直接使用命令来添加</p></blockquote><p>挂载</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -it</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> 宿主机绝对路径目录:容器内目录</span><span style="color:#A31515;"> 镜像名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -it -v /home/ceshi:/home centos /bin/bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看数据卷是否挂载成功 <code>docker inspect 容器id</code></p><figure><img src="/assets/image-20200511192317036-Cq6rEDUN.png" alt="image-20200511192317036" tabindex="0" loading="lazy"><figcaption>image-20200511192317036</figcaption></figure><p>测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到！</p><figure><img src="/assets/image-20200511192452006-_e-szqqN.png" alt="image-20200511192452006" tabindex="0" loading="lazy"><figcaption>image-20200511192452006</figcaption></figure><p>测试容器停止退出后，主机修改数据是否会同步！</p><ol><li>停止容器</li><li>在宿主机上修改文件，增加些内容</li><li>启动刚才停止的容器</li><li>然后查看对应的文件，发现数据依旧同步！ok</li></ol><figure><img src="/assets/image-20200511192712439-DSD7xE6K.png" alt="image-20200511192712439" tabindex="0" loading="lazy"><figcaption>image-20200511192712439</figcaption></figure><blockquote><p>使用 docker 安装 mysql</p></blockquote><p>思考：mysql 数据持久化的问题！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、搜索镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker search mysql</span></span>
<span class="line"><span style="color:#795E26;">NAME</span><span style="color:#A31515;">                              DESCRIPTION</span><span style="color:#A31515;">                                     STARS</span><span style="color:#000000;">              </span></span>
<span class="line"><span style="color:#795E26;">mysql</span><span style="color:#A31515;">                             MySQL</span><span style="color:#A31515;"> is</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> widely</span><span style="color:#A31515;"> used,</span><span style="color:#A31515;"> open-source</span><span style="color:#A31515;"> relation…</span><span style="color:#098658;">   9488</span><span style="color:#000000;">    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、拉取镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker pull mysql:5.7</span></span>
<span class="line"><span style="color:#795E26;">5.7:</span><span style="color:#A31515;"> Pulling</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> library/mysql</span></span>
<span class="line"><span style="color:#795E26;">54fec2fa59d0:</span><span style="color:#A31515;"> Already</span><span style="color:#A31515;"> exists</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">bcc6c6145912:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">951c3d959c9d:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">05de4d0e206e:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">319f0394ef42:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">d9185034607b:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">013a9c64dadc:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">e745b3361626:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">03145d87b451:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">3991a6b182ee:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">62335de06f7d:</span><span style="color:#A31515;"> Pull</span><span style="color:#A31515;"> complete</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">Digest:</span><span style="color:#A31515;"> sha256:e821ca8cc7a44d354486f30c6a193ec6b70a4eed8c8362aeede4e9b8d74b8ebb</span></span>
<span class="line"><span style="color:#795E26;">Status:</span><span style="color:#A31515;"> Downloaded</span><span style="color:#A31515;"> newer</span><span style="color:#A31515;"> image</span><span style="color:#A31515;"> for</span><span style="color:#A31515;"> mysql:5.7</span></span>
<span class="line"><span style="color:#795E26;">docker.io/library/mysql:5.7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、启动容器  -e 环境变量！ </span></span>
<span class="line"><span style="color:#008000;"># 注意： mysql的数据应该不丢失！先体验下 -v 挂载卷！ 参考官方文档</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e </span><span style="color:#001080;">MYSQL_ROOT_PASSWORD</span><span style="color:#000000;">=</span><span style="color:#A31515;">123456</span><span style="color:#795E26;"> --name</span><span style="color:#A31515;"> mysql01</span><span style="color:#A31515;"> mysql:5.7</span></span>
<span class="line"><span style="color:#795E26;">4763fa5c68c4323688102f57938fb10996a0fb902d2812349286529f9378f16c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、使用本地的sqlyog连接测试一下 3310</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 5、查看本地的 /home/mysql 目录</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# pwd</span></span>
<span class="line"><span style="color:#795E26;">/home/mysql/data</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# ls</span></span>
<span class="line"><span style="color:#795E26;">..</span><span style="color:#A31515;"> ...</span><span style="color:#A31515;"> .</span><span style="color:#A31515;">  test</span><span style="color:#008000;">  # 可以看到我们刚刚建立的mysql数据库在本地存储着</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 6、删除mysql容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# docker rm -f mysql01  </span><span style="color:#008000;"># 删除容器，然后发现远程连接失败！</span></span>
<span class="line"><span style="color:#795E26;">mysql01</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen data]# ls</span></span>
<span class="line"><span style="color:#795E26;">..</span><span style="color:#A31515;"> ...</span><span style="color:#A31515;"> .</span><span style="color:#A31515;">  test</span><span style="color:#008000;">       # 可以看到我们刚刚建立的mysql数据库在本地存储着</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>通过Docker File 来添加（了解）</p></blockquote><p>DockerFile 是用来构建Docker镜像的构建文件，是由一些列命令和参数构成的脚本。</p><p>我们在这里，先体验下，后面我们会详细讲解 DockerFile ！</p><p>测试：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、我们在宿主机 /home 目录下新建一个 docker-test-volume文件夹</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# mkdir docker-test-volume</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 说明：在编写DockerFile文件中使用 VOLUME 指令来给镜像添加一个或多个数据卷</span></span>
<span class="line"><span style="color:#795E26;">VOLUME[</span><span style="color:#795E26;">&quot;/dataVolumeContainer1&quot;</span><span style="color:#795E26;">,</span><span style="color:#795E26;">&quot;/dataVolumeContainer2&quot;</span><span style="color:#795E26;">,</span><span style="color:#795E26;">&quot;/dataVolumeContainer3&quot;</span><span style="color:#795E26;">]</span></span>
<span class="line"><span style="color:#008000;"># 出于可移植和分享的考虑，我们之前使用的 -v 主机目录:容器目录 这种方式不能够直接在DockerFile中实现。</span></span>
<span class="line"><span style="color:#008000;"># 由于宿主机目录是依赖于特定宿主机的，并不能够保证在所有宿主机上都存在这样的特定目录.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、编写DockerFile文件</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# pwd</span></span>
<span class="line"><span style="color:#795E26;">/home/docker-test-volume</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# vim dockerfile1</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# cat dockerfile1 </span></span>
<span class="line"><span style="color:#008000;"># volume test</span></span>
<span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;">VOLUME</span><span style="color:#000000;"> [</span><span style="color:#A31515;">&quot;/dataVolumeContainer1&quot;</span><span style="color:#000000;">,</span><span style="color:#A31515;">&quot;/dataVolumeContainer2&quot;</span><span style="color:#000000;">]</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> echo</span><span style="color:#A31515;"> &quot;-------end------&quot;</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、build后生成镜像，获得一个新镜像 kuangshen/centos</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> build</span><span style="color:#0000FF;"> -f</span><span style="color:#A31515;"> /home/docker-test-volume/dockerfile1</span><span style="color:#0000FF;"> -t</span><span style="color:#A31515;"> kuangshen/centos</span><span style="color:#A31515;"> .</span><span style="color:#008000;"> # 注意最后有个.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/assets/image-20200511195440625-DexPw_L0.png" alt="image-20200511195440625" tabindex="0" loading="lazy"><figcaption>image-20200511195440625</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 4、启动容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker run -it 0e97e1891a3d /bin/bash </span><span style="color:#008000;"># 启动容器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@f5824970eefc /]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 56</span></span>
<span class="line"><span style="color:#795E26;">lrwxrwxrwx</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">    7</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#098658;">  2019</span><span style="color:#A31515;"> bin</span><span style="color:#000000;"> -&gt; </span><span style="color:#A31515;">usr/bin</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   2</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 11:55</span><span style="color:#A31515;"> dataVolumeContainer1</span><span style="color:#008000;">   # 数据卷目录</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   2</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 11:55</span><span style="color:#A31515;"> dataVolumeContainer2</span><span style="color:#008000;">   # 数据卷目录</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   5</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">  360</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 11:55</span><span style="color:#A31515;"> dev</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 11:55</span><span style="color:#A31515;"> etc</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   2</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#098658;">  2019</span><span style="color:#A31515;"> home</span></span>
<span class="line"><span style="color:#795E26;">.....</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 问题:通过上述步骤，容器内的卷目录地址就已经知道了，但是对应的主机目录地址在哪里呢？</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 5、我们在数据卷中新建一个文件</span></span>
<span class="line"><span style="color:#000000;">[root@f5824970eefc dataVolumeContainer1]# pwd </span></span>
<span class="line"><span style="color:#795E26;">/dataVolumeContainer1</span></span>
<span class="line"><span style="color:#000000;">[root@f5824970eefc dataVolumeContainer1]# touch container.txt </span></span>
<span class="line"><span style="color:#000000;">[root@f5824970eefc dataVolumeContainer1]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 11:58</span><span style="color:#A31515;"> container.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 6、查看下这个容器的信息</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker inspect 0e97e1891a3d</span></span>
<span class="line"><span style="color:#008000;">#  查看输出的Volumes</span></span>
<span class="line"><span style="color:#795E26;">&quot;Volumes&quot;</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> {</span></span>
<span class="line"><span style="color:#795E26;">    &quot;/dataVolumeContainer1&quot;</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> {},</span></span>
<span class="line"><span style="color:#795E26;">    &quot;/dataVolumeContainer2&quot;</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> {}</span></span>
<span class="line"><span style="color:#000000;">},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 7、这个卷在主机对应的默认位置</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/assets/image-20200511211047471-DQP5J0R3.png" alt="image-20200511211047471" tabindex="0" loading="lazy"><figcaption>image-20200511211047471</figcaption></figure><p>注意：如果访问出现了 cannot open directory: Permission denied</p><p>解决办法：在挂载目录后多加一个 --privileged=true参数即可</p><h2 id="匿名和具名挂载" tabindex="-1"><a class="header-anchor" href="#匿名和具名挂载"><span>匿名和具名挂载</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 匿名挂载</span></span>
<span class="line"><span style="color:#795E26;">-v</span><span style="color:#A31515;"> 容器内路径</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -P</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> nginx01</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /etc/nginx</span><span style="color:#A31515;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 匿名挂载的缺点，就是不好维护，通常使用命令 docker volume维护</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> volume</span><span style="color:#A31515;"> ls</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 具名挂载</span></span>
<span class="line"><span style="color:#795E26;">-v</span><span style="color:#A31515;"> 卷名:/容器内路径</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -P</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> nginx02</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> nginxconfig:/etc/nginx</span><span style="color:#A31515;"> nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看挂载的路径</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker volume inspect nginxconfig</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#A31515;">        &quot;CreatedAt&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;2020-05-13T17:23:00+08:00&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Driver&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;local&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Labels&quot;</span><span style="color:#000000;">: null,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Mountpoint&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;/var/lib/docker/volumes/nginxconfig/_data&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;nginxconfig&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Options&quot;</span><span style="color:#000000;">: null,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Scope&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;local&quot;</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 怎么判断挂载的是卷名而不是本机目录名？</span></span>
<span class="line"><span style="color:#795E26;">不是/开始就是卷名，是/开始就是目录名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 改变文件的读写权限</span></span>
<span class="line"><span style="color:#008000;"># ro: readonly</span></span>
<span class="line"><span style="color:#008000;"># rw: readwrite</span></span>
<span class="line"><span style="color:#008000;"># 指定容器对我们挂载出来的内容的读写权限</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -P</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> nginx02</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> nginxconfig:/etc/nginx:ro</span><span style="color:#A31515;"> nginx</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -P</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> nginx02</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> nginxconfig:/etc/nginx:rw</span><span style="color:#A31515;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据卷容器" tabindex="-1"><a class="header-anchor" href="#数据卷容器"><span>数据卷容器</span></a></h2><p>命名的容器挂载数据卷，其他容器通过挂载这个（父容器）实现数据共享，挂载数据卷的容器，称之为数据卷容器。</p><p>我们使用上一步的镜像：kuangshen/centos 为模板，运行容器 docker01，docker02，docker03，他们都会具有容器卷</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">&quot;/dataVolumeContainer1&quot;</span></span>
<span class="line"><span style="color:#795E26;">&quot;/dataVolumeContainer2&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>我们来测试下，容器间传递共享</strong></p><p>1、先启动一个父容器docker01，然后在dataVolumeContainer2新增文件</p><figure><img src="/assets/image-20200511211931898-CxHeTFgR.png" alt="image-20200511211931898" tabindex="0" loading="lazy"><figcaption>image-20200511211931898</figcaption></figure><figure><img src="/assets/image-20200511212015006-CR1WHVGK.png" alt="image-20200511212015006" tabindex="0" loading="lazy"><figcaption>image-20200511212015006</figcaption></figure><p>退出不停止：ctrl+P+Q</p><p>2、创建docker02，docker03 让他们继承docker01 <code>--volumes-from</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker run -it --name docker02 --volumes-from docker01 kuangshen/centos</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 /]# cd /dataVolumeContainer2</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# ls</span></span>
<span class="line"><span style="color:#795E26;">docker01.txt</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# touch docker02.txt</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# ls</span></span>
<span class="line"><span style="color:#795E26;">docker01.txt</span><span style="color:#A31515;">  docker02.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker run -it --name docker03 --volumes-from docker01 kuangshen/centos</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 /]# cd /dataVolumeContainer2</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# ls</span></span>
<span class="line"><span style="color:#795E26;">docker01.txt</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# touch docker03.txt</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# ls</span></span>
<span class="line"><span style="color:#795E26;">docker01.txt</span><span style="color:#A31515;"> docker02.txt</span><span style="color:#A31515;"> docker03.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、回到docker01发现可以看到 02 和 03 添加的共享文件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker attach docker01</span></span>
<span class="line"><span style="color:#000000;">[root@799b6ea5db7c dataVolumeContainer2]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4、删除docker01，docker02 修改后docker03还能不能访问</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker rm -f docker01</span></span>
<span class="line"><span style="color:#795E26;">docker01</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker attach docker02</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# ls -l                   </span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# touch docker02-update.txt </span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# ls -a</span></span>
<span class="line"><span style="color:#795E26;">.</span><span style="color:#A31515;">  ..</span><span style="color:#A31515;">  docker01.txt</span><span style="color:#A31515;"> docker02.txt</span><span style="color:#A31515;">  docker02-update.txt</span><span style="color:#A31515;">  docker03.txt</span></span>
<span class="line"><span style="color:#000000;">[root@ea4c82779077 dataVolumeContainer2]# Ctrl+P+Q 退出容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker attach docker03</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:29</span><span style="color:#A31515;"> docker02-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、删除docker02 ，docker03还能不能访问</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#000000;">                     </span></span>
<span class="line"><span style="color:#795E26;">95164598b306</span><span style="color:#A31515;">        kuangshen/centos</span></span>
<span class="line"><span style="color:#795E26;">ea4c82779077</span><span style="color:#A31515;">        kuangshen/centos</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker rm -f docker02</span></span>
<span class="line"><span style="color:#795E26;">docker02</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker attach docker03</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:29</span><span style="color:#A31515;"> docker02-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span>
<span class="line"><span style="color:#000000;">[root@95164598b306 dataVolumeContainer2]# touch docker03-update.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、新建docker04继承docker03，然后再删除docker03，看下是否可以访问！</p><figure><img src="/assets/image-20200511213429199-DPsqLPO8.png" alt="image-20200511213429199" tabindex="0" loading="lazy"><figcaption>image-20200511213429199</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@2119f4f23a92 /]# cd dataVolumeContainer2</span></span>
<span class="line"><span style="color:#000000;">[root@2119f4f23a92 dataVolumeContainer2]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:29</span><span style="color:#A31515;"> docker02-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:32</span><span style="color:#A31515;"> docker03-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看当前运行的容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">                     NAMES</span></span>
<span class="line"><span style="color:#795E26;">2119f4f23a92</span><span style="color:#A31515;">        kuangshen/centos</span><span style="color:#A31515;">          docker04</span></span>
<span class="line"><span style="color:#795E26;">95164598b306</span><span style="color:#A31515;">        kuangshen/centos</span><span style="color:#A31515;">          docker03</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 继续删除docker03</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker rm -f docker03</span></span>
<span class="line"><span style="color:#795E26;">docker03</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen docker-test-volume]# docker attach docker04</span></span>
<span class="line"><span style="color:#000000;">[root@2119f4f23a92 dataVolumeContainer2]# ls -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:20</span><span style="color:#A31515;"> docker01.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:22</span><span style="color:#A31515;"> docker02.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:29</span><span style="color:#A31515;"> docker02-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:32</span><span style="color:#A31515;"> docker03-update.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#A31515;"> 13:24</span><span style="color:#A31515;"> docker03.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>得出结论：</strong></p><p><strong>容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用它为止。</strong></p><p><strong>存储在本机的文件则会一直保留！</strong></p><h1 id="dockerfile" tabindex="-1"><a class="header-anchor" href="#dockerfile"><span>DockerFile</span></a></h1><p>大家想想，Nginx，tomcat，mysql 这些镜像都是哪里来的？官方能写，我们不能写吗？</p><p>我们要研究自己如何做一个镜像，而且我们写的微服务项目以及springboot打包上云部署，Docker就是最方便的。</p><p>微服务打包成镜像，任何装了Docker的地方，都可以下载使用，极其的方便。</p><p>流程：开发应用=&gt;DockerFile=&gt;打包为镜像=&gt;上传到仓库（私有仓库，公有仓库）=&gt; 下载镜像 =&gt; 启动运行。</p><p>还可以方便移植！</p><h2 id="什么是dockerfile" tabindex="-1"><a class="header-anchor" href="#什么是dockerfile"><span>什么是DockerFile</span></a></h2><p>dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。</p><p>构建步骤：</p><p>1、编写DockerFile文件</p><p>2、docker build 构建镜像</p><p>3、docker run</p><p>dockerfile文件我们刚才已经编写过了一次，这里我们继续使用 centos 来看！</p><p>地址：https://hub.docker.com/_/centos</p><figure><img src="/assets/image-20200511214530196-CqdKjp2C.png" alt="image-20200511214530196" tabindex="0" loading="lazy"><figcaption>image-20200511214530196</figcaption></figure><figure><img src="/assets/image-20200511214615242-qa14NcB6.png" alt="image-20200511214615242" tabindex="0" loading="lazy"><figcaption>image-20200511214615242</figcaption></figure><h2 id="dockerfile构建过程" tabindex="-1"><a class="header-anchor" href="#dockerfile构建过程"><span>DockerFile构建过程</span></a></h2><p><strong>基础知识：</strong></p><p>1、每条保留字指令都必须为大写字母且后面要跟随至少一个参数</p><p>2、指令按照从上到下，顺序执行</p><p>3、# 表示注释</p><p>4、每条指令都会创建一个新的镜像层，并对镜像进行提交</p><p><strong>流程：</strong></p><p>1、docker从基础镜像运行一个容器</p><p>2、执行一条指令并对容器做出修改</p><p>3、执行类似 docker commit 的操作提交一个新的镜像层</p><p>4、Docker再基于刚提交的镜像运行一个新容器</p><p>5、执行dockerfile中的下一条指令直到所有指令都执行完成！</p><p><strong>说明：</strong></p><p>从应用软件的角度来看，DockerFile，docker镜像与docker容器分别代表软件的三个不同阶段。</p><ul><li>DockerFile 是软件的原材料 （代码）</li><li>Docker 镜像则是软件的交付品 （.apk）</li><li>Docker 容器则是软件的运行状态 （客户下载安装执行）</li></ul><p>DockerFile 面向开发，Docker镜像成为交付标准，Docker容器则涉及部署与运维，三者缺一不可！</p><figure><img src="/assets/image-20200511215535535-Dbp3F6gF.png" alt="image-20200511215535535" tabindex="0" loading="lazy"><figcaption>image-20200511215535535</figcaption></figure><p>DockerFile：需要定义一个DockerFile，DockerFile定义了进程需要的一切东西。DockerFile涉及的内容包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进程和内核进程（当引用进行需要和系统服务和内核进程打交道，这时需要考虑如何设计 namespace的权限控制）等等。</p><p>Docker镜像：在DockerFile 定义了一个文件之后，Docker build 时会产生一个Docker镜像，当运行 Docker 镜像时，会真正开始提供服务；</p><p>Docker容器：容器是直接提供服务的。</p><h2 id="dockerfile指令" tabindex="-1"><a class="header-anchor" href="#dockerfile指令"><span>DockerFile指令</span></a></h2><p><strong>关键字：</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">FROM</span><span style="color:#008000;">         # 基础镜像，当前新镜像是基于哪个镜像的</span></span>
<span class="line"><span style="color:#795E26;">MAINTAINER</span><span style="color:#008000;">   # 镜像维护者的姓名混合邮箱地址</span></span>
<span class="line"><span style="color:#795E26;">RUN</span><span style="color:#008000;">          # 容器构建时需要运行的命令</span></span>
<span class="line"><span style="color:#795E26;">EXPOSE</span><span style="color:#008000;">       # 当前容器对外保留出的端口</span></span>
<span class="line"><span style="color:#795E26;">WORKDIR</span><span style="color:#008000;">      # 指定在创建容器后，终端默认登录的进来工作目录，一个落脚点</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#008000;">          # 用来在构建镜像过程中设置环境变量</span></span>
<span class="line"><span style="color:#795E26;">ADD</span><span style="color:#008000;">          # 将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar压缩包</span></span>
<span class="line"><span style="color:#795E26;">COPY</span><span style="color:#008000;">         # 类似ADD，拷贝文件和目录到镜像中！</span></span>
<span class="line"><span style="color:#795E26;">VOLUME</span><span style="color:#008000;">       # 容器数据卷，用于数据保存和持久化工作</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#008000;">          # 指定一个容器启动时要运行的命令，dockerFile中可以有多个CMD指令，但只有最后一个生效！</span></span>
<span class="line"><span style="color:#795E26;">ENTRYPOINT</span><span style="color:#008000;">   # 指定一个容器启动时要运行的命令！和CMD一样</span></span>
<span class="line"><span style="color:#795E26;">ONBUILD</span><span style="color:#008000;">      # 当构建一个被继承的DockerFile时运行命令，父镜像在被子镜像继承后，父镜像的ONBUILD被触发</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/assets/image-20200511221213932-Nnxl997C.png" alt="image-20200511221213932" tabindex="0" loading="lazy"><figcaption>image-20200511221213932</figcaption></figure><figure><img src="/assets/image-20200511221356937-fV77Ffcd.png" alt="image-20200511221356937" tabindex="0" loading="lazy"><figcaption>image-20200511221356937</figcaption></figure><h2 id="实战测试" tabindex="-1"><a class="header-anchor" href="#实战测试"><span>实战测试</span></a></h2><p>Docker Hub 中99% 的镜像都是通过在base镜像（Scratch）中安装和配置需要的软件构建出来的</p><figure><img src="/assets/image-20200512105654160-MCDueLeN.png" alt="image-20200512105654160" tabindex="0" loading="lazy"><figcaption>image-20200512105654160</figcaption></figure><blockquote><p>自定义一个 centos</p></blockquote><p><strong>1、编写DockerFile</strong></p><p>查看下官方默认的CentOS的情况：</p><figure><img src="/assets/image-20200512110013722-lyzXQ-Cj.png" alt="image-20200512110013722" tabindex="0" loading="lazy"><figcaption>image-20200512110013722</figcaption></figure><p>目的：使我们自己的镜像具备如下：登陆后的默认路径、vim编辑器、查看网络配置ifconfig支持</p><p>准备编写DockerFlie文件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen home]# mkdir dockerfile-test</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# ls</span></span>
<span class="line"><span style="color:#795E26;">ceshi</span><span style="color:#A31515;">  dockerfile-test</span><span style="color:#A31515;">  docker-test-volume</span><span style="color:#A31515;">  f1</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# </span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# vim mydockerfile-centos </span><span style="color:#008000;"># 编辑文件</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# cat mydockerfile-centos </span></span>
<span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;">MAINTAINER</span><span style="color:#A31515;"> kuangshen</span><span style="color:#000000;">&lt;</span><span style="color:#A31515;">24736743@qq.co</span><span style="color:#000000;">m&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> MYPATH</span><span style="color:#A31515;"> /usr/local</span></span>
<span class="line"><span style="color:#795E26;">WORKDIR</span><span style="color:#001080;"> $MYPATH</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">RUN</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> vim</span></span>
<span class="line"><span style="color:#795E26;">RUN</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> net-tools</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">EXPOSE</span><span style="color:#098658;"> 80</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> echo</span><span style="color:#001080;"> $MYPATH</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> echo</span><span style="color:#A31515;"> &quot;----------end--------&quot;</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> /bin/bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2、构建</strong></p><p><code>docker build -f dockerfile地址 -t 新镜像名字:TAG .</code></p><p><mark>会看到 docker build 命令最后有一个 . . 表示当前目录**</mark>**</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen home]# docker build -f mydockerfile-centos -t mycentos:0.1 </span><span style="color:#795E26;">.</span></span>
<span class="line"><span style="color:#795E26;">Sending</span><span style="color:#A31515;"> build</span><span style="color:#A31515;"> context</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> Docker</span><span style="color:#A31515;"> daemon</span><span style="color:#A31515;">  6.144kB</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 1/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">470671670cac</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 2/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> MAINTAINER</span><span style="color:#A31515;"> kuangshen</span><span style="color:#000000;">&lt;</span><span style="color:#A31515;">24736743@qq.co</span><span style="color:#000000;">m&gt;</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> ac052943c151</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> ac052943c151</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">9d37c7174860</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 3/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> ENV</span><span style="color:#A31515;"> MYPATH</span><span style="color:#A31515;"> /usr/local</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> a9d43e0b41bb</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> a9d43e0b41bb</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">7a89b945c3a6</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 4/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> WORKDIR</span><span style="color:#001080;"> $MYPATH</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> b41f085b06bc</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> b41f085b06bc</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">022384682f07</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 5/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> RUN</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> vim</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> 8a8d351ee43b</span></span>
<span class="line"><span style="color:#795E26;">CentOS-8</span><span style="color:#A31515;"> -</span><span style="color:#A31515;"> AppStream</span><span style="color:#098658;">                            2.7</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">7.0</span><span style="color:#A31515;"> MB</span><span style="color:#A31515;">     00:02</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">CentOS-8</span><span style="color:#A31515;"> -</span><span style="color:#A31515;"> Base</span><span style="color:#098658;">                                 1.1</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">2.2</span><span style="color:#A31515;"> MB</span><span style="color:#A31515;">     00:02</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">CentOS-8</span><span style="color:#A31515;"> -</span><span style="color:#A31515;"> Extras</span><span style="color:#098658;">                               6.3</span><span style="color:#A31515;"> kB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">5.9</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">Dependencies</span><span style="color:#A31515;"> resolved.</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;"> Package</span><span style="color:#A31515;">             Arch</span><span style="color:#A31515;">        Version</span><span style="color:#A31515;">                   Repository</span><span style="color:#A31515;">      Size</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;">Installing:</span></span>
<span class="line"><span style="color:#795E26;"> vim-enhanced</span><span style="color:#A31515;">        x86_64</span><span style="color:#A31515;">      2:8.0.1763-13.el8</span><span style="color:#A31515;">         AppStream</span><span style="color:#098658;">      1.4</span><span style="color:#A31515;"> M</span></span>
<span class="line"><span style="color:#795E26;">Installing</span><span style="color:#A31515;"> dependencies:</span></span>
<span class="line"><span style="color:#795E26;"> gpm-libs</span><span style="color:#A31515;">            x86_64</span><span style="color:#A31515;">      1.20.7-15.el8</span><span style="color:#A31515;">             AppStream</span><span style="color:#098658;">       39</span><span style="color:#A31515;"> k</span></span>
<span class="line"><span style="color:#795E26;"> vim-common</span><span style="color:#A31515;">          x86_64</span><span style="color:#A31515;">      2:8.0.1763-13.el8</span><span style="color:#A31515;">         AppStream</span><span style="color:#098658;">      6.3</span><span style="color:#A31515;"> M</span></span>
<span class="line"><span style="color:#795E26;"> vim-filesystem</span><span style="color:#A31515;">      noarch</span><span style="color:#A31515;">      2:8.0.1763-13.el8</span><span style="color:#A31515;">         AppStream</span><span style="color:#098658;">       48</span><span style="color:#A31515;"> k</span></span>
<span class="line"><span style="color:#795E26;"> which</span><span style="color:#A31515;">               x86_64</span><span style="color:#A31515;">      2.21-10.el8</span><span style="color:#A31515;">               BaseOS</span><span style="color:#098658;">          49</span><span style="color:#A31515;"> k</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> Summary</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;">Install</span><span style="color:#098658;">  5</span><span style="color:#A31515;"> Packages</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Total</span><span style="color:#A31515;"> download</span><span style="color:#A31515;"> size:</span><span style="color:#098658;"> 7.8</span><span style="color:#A31515;"> M</span></span>
<span class="line"><span style="color:#795E26;">Installed</span><span style="color:#A31515;"> size:</span><span style="color:#098658;"> 31</span><span style="color:#A31515;"> M</span></span>
<span class="line"><span style="color:#795E26;">Downloading</span><span style="color:#A31515;"> Packages:</span></span>
<span class="line"><span style="color:#000000;">(</span><span style="color:#795E26;">1/5</span><span style="color:#000000;">)</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> gpm-libs-1.20.7-15.el8.x86_64.rpm</span><span style="color:#098658;">        815</span><span style="color:#A31515;"> kB/s</span><span style="color:#000000;"> |  </span><span style="color:#795E26;">39</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#000000;">(</span><span style="color:#795E26;">2/5</span><span style="color:#000000;">)</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> vim-filesystem-8.0.1763-13.el8.noarch.rp</span><span style="color:#098658;"> 2.1</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> |  </span><span style="color:#795E26;">48</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#000000;">(</span><span style="color:#795E26;">3/5</span><span style="color:#000000;">)</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> which-2.21-10.el8.x86_64.rpm</span><span style="color:#098658;">             161</span><span style="color:#A31515;"> kB/s</span><span style="color:#000000;"> |  </span><span style="color:#795E26;">49</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#000000;">(</span><span style="color:#795E26;">4/5</span><span style="color:#000000;">)</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> vim-enhanced-8.0.1763-13.el8.x86_64.rpm</span><span style="color:#098658;">  3.1</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">1.4</span><span style="color:#A31515;"> MB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#000000;">(</span><span style="color:#795E26;">5/5</span><span style="color:#000000;">)</span><span style="color:#795E26;">:</span><span style="color:#A31515;"> vim-common-8.0.1763-13.el8.x86_64.rpm</span><span style="color:#098658;">    1.4</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">6.3</span><span style="color:#A31515;"> MB</span><span style="color:#A31515;">     00:04</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#795E26;">Total</span><span style="color:#098658;">                                           1.4</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">7.8</span><span style="color:#A31515;"> MB</span><span style="color:#A31515;">     00:05</span><span style="color:#000000;">     </span></span>
<span class="line"><span style="color:#795E26;">warning:</span><span style="color:#A31515;"> /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm:</span><span style="color:#A31515;"> Header</span><span style="color:#A31515;"> V3</span><span style="color:#A31515;"> RSA/SHA256</span><span style="color:#A31515;"> Signature,</span><span style="color:#A31515;"> key</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;"> 8483c65d:</span><span style="color:#A31515;"> NOKEY</span></span>
<span class="line"><span style="color:#795E26;">CentOS-8</span><span style="color:#A31515;"> -</span><span style="color:#A31515;"> AppStream</span><span style="color:#098658;">                            786</span><span style="color:#A31515;"> kB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">1.6</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">Importing</span><span style="color:#A31515;"> GPG</span><span style="color:#A31515;"> key</span><span style="color:#A31515;"> 0x8483C65D:</span></span>
<span class="line"><span style="color:#795E26;"> Userid</span><span style="color:#A31515;">     :</span><span style="color:#A31515;"> &quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span></span>
<span class="line"><span style="color:#795E26;"> Fingerprint:</span><span style="color:#A31515;"> 99DB</span><span style="color:#A31515;"> 70FA</span><span style="color:#A31515;"> E1D7</span><span style="color:#A31515;"> CE22</span><span style="color:#A31515;"> 7FB6</span><span style="color:#098658;"> 4882</span><span style="color:#A31515;"> 05B5</span><span style="color:#A31515;"> 55B3</span><span style="color:#098658;"> 8483</span><span style="color:#A31515;"> C65D</span></span>
<span class="line"><span style="color:#795E26;"> From</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span></span>
<span class="line"><span style="color:#795E26;">Key</span><span style="color:#A31515;"> imported</span><span style="color:#A31515;"> successfully</span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span><span style="color:#A31515;"> check</span></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> check</span><span style="color:#A31515;"> succeeded.</span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span><span style="color:#A31515;"> test</span></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> test</span><span style="color:#A31515;"> succeeded.</span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span></span>
<span class="line"><span style="color:#795E26;">  Preparing</span><span style="color:#A31515;">        :</span><span style="color:#A31515;">                                                        1/1</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> which-2.21-10.el8.x86_64</span><span style="color:#A31515;">                               1/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> vim-filesystem-2:8.0.1763-13.el8.noarch</span><span style="color:#A31515;">                2/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> vim-common-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                    3/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> gpm-libs-1.20.7-15.el8.x86_64</span><span style="color:#A31515;">                          4/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Running</span><span style="color:#A31515;"> scriptlet:</span><span style="color:#A31515;"> gpm-libs-1.20.7-15.el8.x86_64</span><span style="color:#A31515;">                          4/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> vim-enhanced-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                  5/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Running</span><span style="color:#A31515;"> scriptlet:</span><span style="color:#A31515;"> vim-enhanced-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                  5/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Running</span><span style="color:#A31515;"> scriptlet:</span><span style="color:#A31515;"> vim-common-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                    5/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> gpm-libs-1.20.7-15.el8.x86_64</span><span style="color:#A31515;">                          1/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> vim-common-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                    2/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> vim-enhanced-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">                  3/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> vim-filesystem-2:8.0.1763-13.el8.noarch</span><span style="color:#A31515;">                4/5</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> which-2.21-10.el8.x86_64</span><span style="color:#A31515;">                               5/5</span><span style="color:#000000;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Installed:</span></span>
<span class="line"><span style="color:#795E26;">  vim-enhanced-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;"> gpm-libs-1.20.7-15.el8.x86_64</span><span style="color:#000000;">          </span></span>
<span class="line"><span style="color:#795E26;">  vim-common-2:8.0.1763-13.el8.x86_64</span><span style="color:#A31515;">   vim-filesystem-2:8.0.1763-13.el8.noarch</span></span>
<span class="line"><span style="color:#795E26;">  which-2.21-10.el8.x86_64</span><span style="color:#000000;">             </span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Complete!</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> 8a8d351ee43b</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">6f6449a55974</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 6/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> RUN</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> net-tools</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> 4f2c187b0bed</span></span>
<span class="line"><span style="color:#795E26;">Last</span><span style="color:#A31515;"> metadata</span><span style="color:#A31515;"> expiration</span><span style="color:#A31515;"> check:</span><span style="color:#A31515;"> 0:00:12</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;"> on</span><span style="color:#A31515;"> Tue</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 03:07:25</span><span style="color:#A31515;"> 2020.</span></span>
<span class="line"><span style="color:#795E26;">Dependencies</span><span style="color:#A31515;"> resolved.</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;"> Package</span><span style="color:#A31515;">         Architecture</span><span style="color:#A31515;"> Version</span><span style="color:#A31515;">                        Repository</span><span style="color:#A31515;">    Size</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;">Installing:</span></span>
<span class="line"><span style="color:#795E26;"> net-tools</span><span style="color:#A31515;">       x86_64</span><span style="color:#A31515;">       2.0-0.51.20160912git.el8</span><span style="color:#A31515;">       BaseOS</span><span style="color:#098658;">       323</span><span style="color:#A31515;"> k</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> Summary</span></span>
<span class="line"><span style="color:#A31515;">================================================================================</span></span>
<span class="line"><span style="color:#795E26;">Install</span><span style="color:#098658;">  1</span><span style="color:#A31515;"> Package</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Total</span><span style="color:#A31515;"> download</span><span style="color:#A31515;"> size:</span><span style="color:#098658;"> 323</span><span style="color:#A31515;"> k</span></span>
<span class="line"><span style="color:#795E26;">Installed</span><span style="color:#A31515;"> size:</span><span style="color:#098658;"> 1.0</span><span style="color:#A31515;"> M</span></span>
<span class="line"><span style="color:#795E26;">Downloading</span><span style="color:#A31515;"> Packages:</span></span>
<span class="line"><span style="color:#795E26;">net-tools-2.0-0.51.20160912git.el8.x86_64.rpm</span><span style="color:#098658;">   1.3</span><span style="color:#A31515;"> MB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">323</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">    </span></span>
<span class="line"><span style="color:#795E26;">--------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#795E26;">Total</span><span style="color:#098658;">                                           397</span><span style="color:#A31515;"> kB/s</span><span style="color:#000000;"> | </span><span style="color:#795E26;">323</span><span style="color:#A31515;"> kB</span><span style="color:#A31515;">     00:00</span><span style="color:#000000;">     </span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span><span style="color:#A31515;"> check</span></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> check</span><span style="color:#A31515;"> succeeded.</span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span><span style="color:#A31515;"> test</span></span>
<span class="line"><span style="color:#795E26;">Transaction</span><span style="color:#A31515;"> test</span><span style="color:#A31515;"> succeeded.</span></span>
<span class="line"><span style="color:#795E26;">Running</span><span style="color:#A31515;"> transaction</span></span>
<span class="line"><span style="color:#795E26;">  Preparing</span><span style="color:#A31515;">        :</span><span style="color:#A31515;">                                                        1/1</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Installing</span><span style="color:#A31515;">       :</span><span style="color:#A31515;"> net-tools-2.0-0.51.20160912git.el8.x86_64</span><span style="color:#A31515;">              1/1</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Running</span><span style="color:#A31515;"> scriptlet:</span><span style="color:#A31515;"> net-tools-2.0-0.51.20160912git.el8.x86_64</span><span style="color:#A31515;">              1/1</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">  Verifying</span><span style="color:#A31515;">        :</span><span style="color:#A31515;"> net-tools-2.0-0.51.20160912git.el8.x86_64</span><span style="color:#A31515;">              1/1</span><span style="color:#000000;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Installed:</span></span>
<span class="line"><span style="color:#795E26;">  net-tools-2.0-0.51.20160912git.el8.x86_64</span><span style="color:#000000;">                                     </span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Complete!</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> 4f2c187b0bed</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">3055316b02b9</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 7/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> EXPOSE</span><span style="color:#098658;"> 80</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> 37148d44f075</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> 37148d44f075</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">dd8bc8a4e724</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 8/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> CMD</span><span style="color:#A31515;"> echo</span><span style="color:#001080;"> $MYPATH</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> 683039d5befd</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> 683039d5befd</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">cd3c78f8143e</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 9/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> CMD</span><span style="color:#A31515;"> echo</span><span style="color:#A31515;"> &quot;----------end--------&quot;</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> d80e54fbc8ae</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> d80e54fbc8ae</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">c5b5391196c7</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 10/10</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> CMD</span><span style="color:#A31515;"> /bin/bash</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> 5564a62d36da</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> 5564a62d36da</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">18888023317c</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> built</span><span style="color:#A31515;"> 18888023317c</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> tagged</span><span style="color:#A31515;"> mycentos:0.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3、运行</strong></p><p><code>docker run -it 新镜像名字:TAG</code></p><figure><img src="/assets/image-20200512111051438-DybF6b21.png" alt="image-20200512111051438" tabindex="0" loading="lazy"><figcaption>image-20200512111051438</figcaption></figure><p>可以看到，我们自己的新镜像已经支持 vim/ifconfig的命令，扩展OK！</p><p><strong>4、列出镜像地的变更历史</strong></p><p><code>docker history 镜像名</code></p><figure><img src="/assets/image-20200512111233918-CDXoTFvs.png" alt="image-20200512111233918" tabindex="0" loading="lazy"><figcaption>image-20200512111233918</figcaption></figure><blockquote><p>CMD 和 ENTRYPOINT 的区别</p></blockquote><p>我们之前说过，两个命令都是指定一个容器启动时要运行的命令</p><p>**CMD：**Dockerfile 中可以有多个CMD 指令，但只有最后一个生效，CMD 会被 docker run 之后的参数替换！</p><p><strong>ENTRYPOINT：</strong> docker run 之后的参数会被当做参数传递给 ENTRYPOINT，之后形成新的命令组合！</p><p><strong>测试：</strong></p><p>CMD命令</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、构建dockerfile</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# vim dockerfile-cmd-test </span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# cat dockerfile-cmd-test </span></span>
<span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#000000;"> [ </span><span style="color:#A31515;">&quot;ls&quot;,</span><span style="color:#A31515;"> &quot;-a&quot;</span><span style="color:#A31515;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、build 镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker build -f dockerfile-cmd-test -t cmdtest </span><span style="color:#795E26;">.</span></span>
<span class="line"><span style="color:#795E26;">Sending</span><span style="color:#A31515;"> build</span><span style="color:#A31515;"> context</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> Docker</span><span style="color:#A31515;"> daemon</span><span style="color:#A31515;">  22.02kB</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 1/2</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">470671670cac</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 2/2</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> CMD</span><span style="color:#000000;"> [ </span><span style="color:#A31515;">&quot;ls&quot;,</span><span style="color:#A31515;"> &quot;-a&quot;</span><span style="color:#A31515;"> ]</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> a3072987de38</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> a3072987de38</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">554bc6952657</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> built</span><span style="color:#A31515;"> 554bc6952657</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> tagged</span><span style="color:#A31515;"> cmdtest:latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、执行</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker run 554bc6952657</span></span>
<span class="line"><span style="color:#795E26;">.dockerenv</span></span>
<span class="line"><span style="color:#795E26;">bin</span></span>
<span class="line"><span style="color:#795E26;">dev</span></span>
<span class="line"><span style="color:#795E26;">etc</span></span>
<span class="line"><span style="color:#795E26;">home</span></span>
<span class="line"><span style="color:#795E26;">lib</span></span>
<span class="line"><span style="color:#795E26;">lib64</span></span>
<span class="line"><span style="color:#795E26;">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、如果我们希望用 -l 列表展示信息，我们就需要加上 -l参数</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker run cmdtest -l</span></span>
<span class="line"><span style="color:#795E26;">docker:</span><span style="color:#A31515;"> Error</span><span style="color:#A31515;"> response</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> daemon:</span><span style="color:#A31515;"> OCI</span><span style="color:#A31515;"> runtime</span><span style="color:#A31515;"> create</span><span style="color:#A31515;"> failed:</span><span style="color:#A31515;"> container_linux.go:349:</span><span style="color:#A31515;"> starting</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> process</span><span style="color:#A31515;"> caused</span><span style="color:#A31515;"> &quot;exec: </span><span style="color:#EE0000;">\&quot;</span><span style="color:#A31515;">-l</span><span style="color:#EE0000;">\&quot;</span><span style="color:#A31515;">: executable file not found in </span><span style="color:#001080;">$PATH</span><span style="color:#A31515;">&quot;:</span><span style="color:#A31515;"> unknown.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 问题：我们可以看到可执行文件找不到的报错，executable file not found。</span></span>
<span class="line"><span style="color:#008000;"># 之前我们说过，跟在镜像名后面的是 command，运行时会替换 CMD 的默认值。</span></span>
<span class="line"><span style="color:#008000;"># 因此这里的 -l 替换了原来的 CMD，而不是添加在原来的 ls -a 后面。而 -l 根本不是命令，所以自然找不到。</span></span>
<span class="line"><span style="color:#008000;"># 那么如果我们希望加入 -l 这参数，我们就必须重新完整的输入这个命令：</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#A31515;"> cmdtest</span><span style="color:#A31515;"> ls</span><span style="color:#0000FF;"> -al</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ENTRYPOINT命令</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、构建dockerfile</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# vim dockerfile-entrypoint-test </span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# cat dockerfile-entrypoint-test </span></span>
<span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;">ENTRYPOINT</span><span style="color:#000000;"> [ </span><span style="color:#A31515;">&quot;ls&quot;,</span><span style="color:#A31515;"> &quot;-a&quot;</span><span style="color:#A31515;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、build 镜像</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker build -f dockerfile-entrypoint-test -t entrypointtest </span><span style="color:#795E26;">.</span></span>
<span class="line"><span style="color:#795E26;">Sending</span><span style="color:#A31515;"> build</span><span style="color:#A31515;"> context</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> Docker</span><span style="color:#A31515;"> daemon</span><span style="color:#A31515;">  23.04kB</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 1/2</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">470671670cac</span></span>
<span class="line"><span style="color:#795E26;">Step</span><span style="color:#A31515;"> 2/2</span><span style="color:#A31515;"> :</span><span style="color:#A31515;"> ENTRYPOINT</span><span style="color:#000000;"> [ </span><span style="color:#A31515;">&quot;ls&quot;,</span><span style="color:#A31515;"> &quot;-a&quot;</span><span style="color:#A31515;"> ]</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">Running</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> bac4ae055630</span></span>
<span class="line"><span style="color:#795E26;">Removing</span><span style="color:#A31515;"> intermediate</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> bac4ae055630</span></span>
<span class="line"><span style="color:#795E26;"> ---</span><span style="color:#000000;">&gt; </span><span style="color:#A31515;">ae07199f9144</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> built</span><span style="color:#A31515;"> ae07199f9144</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> tagged</span><span style="color:#A31515;"> entrypointtest:latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、执行</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker run ae07199f9144</span></span>
<span class="line"><span style="color:#795E26;">.dockerenv</span></span>
<span class="line"><span style="color:#795E26;">bin</span></span>
<span class="line"><span style="color:#795E26;">dev</span></span>
<span class="line"><span style="color:#795E26;">etc</span></span>
<span class="line"><span style="color:#795E26;">home</span></span>
<span class="line"><span style="color:#795E26;">lib</span></span>
<span class="line"><span style="color:#795E26;">lib64</span></span>
<span class="line"><span style="color:#795E26;">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 4、测试-l参数，发现可以直接使用，这里就是一种追加，我们可以明显的知道 CMD 和 ENTRYPOINT 的区别了</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen home]# docker run entrypointtest -l</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 56</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 04:21</span><span style="color:#A31515;"> .</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 04:21</span><span style="color:#A31515;"> ..</span></span>
<span class="line"><span style="color:#795E26;">-rwxr-xr-x</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">    0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 04:21</span><span style="color:#A31515;"> .dockerenv</span></span>
<span class="line"><span style="color:#795E26;">lrwxrwxrwx</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">    7</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#098658;">  2019</span><span style="color:#A31515;"> bin</span><span style="color:#000000;"> -&gt; </span><span style="color:#A31515;">usr/bin</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   5</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">  340</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 04:21</span><span style="color:#A31515;"> dev</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 04:21</span><span style="color:#A31515;"> etc</span></span>
<span class="line"><span style="color:#795E26;">drwxr-xr-x</span><span style="color:#098658;">   2</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 4096</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 11</span><span style="color:#098658;">  2019</span><span style="color:#A31515;"> home</span></span>
<span class="line"><span style="color:#795E26;">.....</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>自定义镜像 tomcat</p></blockquote><p>1、<code>mkdir -p kuangshen/build/tomcat</code></p><p>2、在上述目录下 touch read.txt</p><p>3、将 JDK 和 tomcat 安装的压缩包拷贝进上一步目录</p><p>4、在 /kuangshen/build/tomcat 目录下新建一个Dockerfile文件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># vim Dockerfile</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> centos</span></span>
<span class="line"><span style="color:#795E26;">MAINTAINER</span><span style="color:#A31515;"> kuangshen</span><span style="color:#000000;">&lt;</span><span style="color:#A31515;">24736743@qq.co</span><span style="color:#000000;">m&gt;</span></span>
<span class="line"><span style="color:#000000;">[[把宿主机当前上下文的read]].txt拷贝到容器/usr/local/路径下</span></span>
<span class="line"><span style="color:#795E26;">COPY</span><span style="color:#A31515;"> read.txt</span><span style="color:#A31515;"> /usr/local/cincontainer.txt</span></span>
<span class="line"><span style="color:#000000;">[[把java与tomcat添加到容器中]]</span></span>
<span class="line"><span style="color:#795E26;">ADD</span><span style="color:#A31515;"> jdk-8u11-linux-x64.tar.gz</span><span style="color:#A31515;"> /usr/local/</span></span>
<span class="line"><span style="color:#795E26;">ADD</span><span style="color:#A31515;"> apache-tomcat-9.0.22.tar.gz</span><span style="color:#A31515;"> /usr/local/</span></span>
<span class="line"><span style="color:#000000;">[[安装vim编辑器]]</span></span>
<span class="line"><span style="color:#795E26;">RUN</span><span style="color:#A31515;"> yum</span><span style="color:#0000FF;"> -y</span><span style="color:#A31515;"> install</span><span style="color:#A31515;"> vim</span></span>
<span class="line"><span style="color:#000000;">[[设置工作访问时候的WORKDIR路径，登录落脚点]]</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> MYPATH</span><span style="color:#A31515;"> /usr/local</span></span>
<span class="line"><span style="color:#795E26;">WORKDIR</span><span style="color:#001080;"> $MYPATH</span></span>
<span class="line"><span style="color:#000000;">[[配置java与tomcat环境变量]]</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> JAVA_HOME</span><span style="color:#A31515;"> /usr/local/jdk1.8.0_11</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> CLASSPATH</span><span style="color:#001080;"> $JAVA_HOME</span><span style="color:#A31515;">/lib/dt.jar:</span><span style="color:#001080;">$JAVA_HOME</span><span style="color:#A31515;">/lib/tools.jar</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> CATALINA_HOME</span><span style="color:#A31515;"> /usr/local/apache-tomcat-9.0.22</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> CATALINA_BASE</span><span style="color:#A31515;"> /usr/local/apache-tomcat-9.0.22</span></span>
<span class="line"><span style="color:#795E26;">ENV</span><span style="color:#A31515;"> PATH</span><span style="color:#001080;"> $PATH</span><span style="color:#A31515;">:</span><span style="color:#001080;">$JAVA_HOME</span><span style="color:#A31515;">/bin:</span><span style="color:#001080;">$CATALINA_HOME</span><span style="color:#A31515;">/lib:</span><span style="color:#001080;">$CATALINA_HOME</span><span style="color:#A31515;">/bin</span></span>
<span class="line"><span style="color:#000000;">[[容器运行时监听的端口]]</span></span>
<span class="line"><span style="color:#795E26;">EXPOSE</span><span style="color:#098658;"> 8080</span></span>
<span class="line"><span style="color:#000000;">[[启动时运行tomcat]]</span></span>
<span class="line"><span style="color:#008000;"># ENTRYPOINT [&quot;/usr/local/apache-tomcat-9.0.22/bin/startup.sh&quot; ]</span></span>
<span class="line"><span style="color:#008000;"># CMD [&quot;/usr/local/apache-tomcat-9.0.22/bin/catalina.sh&quot;,&quot;run&quot;]</span></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#A31515;"> /usr/local/apache-tomcat-9.0.22/bin/startup.sh</span><span style="color:#000000;"> &amp;&amp; </span><span style="color:#795E26;">tail</span><span style="color:#0000FF;"> -F</span><span style="color:#A31515;"> /usr/local/apache-tomcat-9.0.22/bin/logs/catalina.out</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当前文件状态</p><figure><img src="/assets/image-20200512124227041-DeeH155V.png" alt="image-20200512124227041" tabindex="0" loading="lazy"><figcaption>image-20200512124227041</figcaption></figure><p>5、构建镜像</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker build -t diytomcat </span><span style="color:#795E26;">.</span></span>
<span class="line"><span style="color:#795E26;">.....</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> built</span><span style="color:#A31515;"> ffdf6529937d</span></span>
<span class="line"><span style="color:#795E26;">Successfully</span><span style="color:#A31515;"> tagged</span><span style="color:#A31515;"> diytomcat:latest</span><span style="color:#008000;">  # 构建完成</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看确定构建完毕！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker images</span></span>
<span class="line"><span style="color:#795E26;">REPOSITORY</span><span style="color:#A31515;">          TAG</span><span style="color:#A31515;">                 IMAGE</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">            CREATED</span><span style="color:#A31515;">             SIZE</span></span>
<span class="line"><span style="color:#795E26;">diytomcat</span><span style="color:#A31515;">           latest</span><span style="color:#A31515;">              ffdf6529937d</span><span style="color:#098658;">        20</span><span style="color:#A31515;"> seconds</span><span style="color:#A31515;"> ago</span><span style="color:#A31515;">      636MB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、运行启动 run</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 9090:8080</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> mydiytomcat</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /home/kuangshen/build/tomcat/test:/usr/local/apache-tomcat-9.0.22/webapps/test</span><span style="color:#0000FF;"> -v</span><span style="color:#A31515;"> /home/kuangshen/build/tomcat/tomcat9logs/:/usr/local/apache-tomcat-9.0.22/logs</span><span style="color:#0000FF;"> --privileged=true</span><span style="color:#A31515;"> diytomcat</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="/assets/image-20200512124726463-gHG10tRX.png" alt="image-20200512124726463" tabindex="0" loading="lazy"><figcaption>image-20200512124726463</figcaption></figure><p>备注：Docker挂载主机目录Docker访问出现cannot open directory .: Permission denied</p><p>解决办法：在挂载目录后多加一个--privileged=true参数即可</p><p>7、验证测试访问！ <code>curl localhost:9090</code></p><figure><img src="/assets/image-20200512124834411-DhrXY8VS.png" alt="image-20200512124834411" tabindex="0" loading="lazy"><figcaption>image-20200512124834411</figcaption></figure><p>8、结合前面学习的容器卷将测试的web服务test发布</p><figure><img src="/assets/image-20200512125139202-SNUbcs-j.png" alt="image-20200512125139202" tabindex="0" loading="lazy"><figcaption>image-20200512125139202</figcaption></figure><p>web.xml</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#800000;">&lt;?xml</span><span style="color:#E50000;"> version</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;1.0&quot;</span><span style="color:#E50000;"> encoding</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;UTF-8&quot;</span><span style="color:#800000;">?&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#800000;">&lt;web-app</span><span style="color:#E50000;"> xmlns:xsi</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="line"><span style="color:#E50000;">  xmlns</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span>
<span class="line"><span style="color:#E50000;">  xsi:schemaLocation</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span></span>
<span class="line"><span style="color:#E50000;">  id</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;WebApp_ID&quot;</span><span style="color:#E50000;"> version</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;2.5&quot;</span><span style="color:#800000;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#800000;">  &lt;display-name&gt;</span><span style="color:#000000;">test</span><span style="color:#800000;">&lt;/display-name&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#800000;">&lt;/web-app&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>a.jsp</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#0000FF;">&lt;%@</span><span style="color:#0000FF;"> page</span><span style="color:#000000;"> language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; </span><span style="color:#0000FF;">page</span><span style="color:#000000;">Encoding=&quot;UTF-8&quot;</span><span style="color:#0000FF;">%&gt;</span></span>
<span class="line"><span style="color:#800000;">&lt;!</span><span style="color:#0000FF;">DOCTYPE</span><span style="color:#0000FF;"> html</span><span style="color:#000000;"> PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span><span style="color:#800000;">&gt;</span></span>
<span class="line"><span style="color:#800000;">&lt;html&gt;</span></span>
<span class="line"><span style="color:#800000;">  &lt;head&gt;</span></span>
<span class="line"><span style="color:#800000;">    &lt;meta</span><span style="color:#E50000;"> http-equiv</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;Content-Type&quot;</span><span style="color:#E50000;"> content</span><span style="color:#000000;">=</span><span style="color:#0000FF;">&quot;text/html; charset=UTF-8&quot;</span><span style="color:#800000;">&gt;</span></span>
<span class="line"><span style="color:#800000;">    &lt;title&gt;</span><span style="color:#000000;">hello，kuangshen</span><span style="color:#800000;">&lt;/title&gt;</span></span>
<span class="line"><span style="color:#800000;">  &lt;/head&gt;</span></span>
<span class="line"><span style="color:#800000;">  &lt;body&gt;</span></span>
<span class="line"><span style="color:#000000;">    -----------welcome------------</span></span>
<span class="line"><span style="color:#0000FF;">    &lt;%=</span><span style="color:#A31515;">&quot; my docker tomcat，kuangshen666 &quot;</span><span style="color:#0000FF;">%&gt;</span></span>
<span class="line"><span style="color:#800000;">    &lt;br&gt;</span></span>
<span class="line"><span style="color:#800000;">    &lt;br&gt;</span></span>
<span class="line"><span style="color:#0000FF;">    &lt;%</span><span style="color:#001080;"> System</span><span style="color:#000000;">.</span><span style="color:#001080;">out</span><span style="color:#000000;">.</span><span style="color:#795E26;">println</span><span style="color:#000000;">(</span><span style="color:#A31515;">&quot;-------my docker tomcat-------&quot;</span><span style="color:#000000;">);</span><span style="color:#0000FF;">%&gt;</span></span>
<span class="line"><span style="color:#800000;">  &lt;/body&gt;</span></span>
<span class="line"><span style="color:#800000;">&lt;/html&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>9、测试</p><figure><img src="/assets/image-20200512125355807-3Yc1Ajs7.png" alt="image-20200512125355807" tabindex="0" loading="lazy"><figcaption>image-20200512125355807</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 查看日志</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# cd tomcat9logs/</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat9logs]# ll</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 24</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 6993</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:50</span><span style="color:#A31515;"> catalina.2020-05-12.log</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 7024</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:53</span><span style="color:#A31515;"> catalina.out</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">    0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:47</span><span style="color:#A31515;"> host-manager.2020-05-12.log</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">  408</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:47</span><span style="color:#A31515;"> localhost.2020-05-12.log</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">  150</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:53</span><span style="color:#A31515;"> localhost_access_log.2020-05-12.txt</span></span>
<span class="line"><span style="color:#795E26;">-rw-r-----</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">    0</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 12</span><span style="color:#A31515;"> 12:47</span><span style="color:#A31515;"> manager.2020-05-12.log</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat9logs]# cat catalina.out </span></span>
<span class="line"><span style="color:#795E26;">....</span></span>
<span class="line"><span style="color:#795E26;">-------my</span><span style="color:#A31515;"> docker</span><span style="color:#A31515;"> tomcat-------</span><span style="color:#008000;">  # 搞定</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="发布镜像" tabindex="-1"><a class="header-anchor" href="#发布镜像"><span>发布镜像</span></a></h2><blockquote><p>DockerHub</p></blockquote><p>注册dockerhub https://hub.docker.com/signup，需要有一个账号</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、查看登录命令</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker login --help</span></span>
<span class="line"><span style="color:#795E26;">Usage:</span><span style="color:#A31515;">	docker</span><span style="color:#A31515;"> login</span><span style="color:#000000;"> [OPTIONS] [SERVER]</span></span>
<span class="line"><span style="color:#008000;"># 2、登录</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker login -u kuangshen</span></span>
<span class="line"><span style="color:#795E26;">Password:</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">WARNING!</span><span style="color:#A31515;"> Your</span><span style="color:#A31515;"> password</span><span style="color:#A31515;"> will</span><span style="color:#A31515;"> be</span><span style="color:#A31515;"> stored</span><span style="color:#A31515;"> unencrypted</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> /root/.docker/config.json.</span></span>
<span class="line"><span style="color:#795E26;">Configure</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> credential</span><span style="color:#A31515;"> helper</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> remove</span><span style="color:#A31515;"> this</span><span style="color:#A31515;"> warning.</span><span style="color:#A31515;"> See</span></span>
<span class="line"><span style="color:#795E26;">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span></span>
<span class="line"><span style="color:#795E26;">Login</span><span style="color:#A31515;"> Succeeded</span></span>
<span class="line"><span style="color:#008000;"># 3、将镜像发布出去   </span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker push kuangshen/diytomcat:1.0</span></span>
<span class="line"><span style="color:#795E26;">The</span><span style="color:#A31515;"> push</span><span style="color:#A31515;"> refers</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> repository</span><span style="color:#000000;"> [docker.io/library/diytomcat]</span></span>
<span class="line"><span style="color:#795E26;">0f02399c6fdf:</span><span style="color:#A31515;"> Preparing</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">e79ea0c3a34e:</span><span style="color:#A31515;"> Preparing</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">09281fa8fe38:</span><span style="color:#A31515;"> Preparing</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">b56a902b0aef:</span><span style="color:#A31515;"> Preparing</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">0683de282177:</span><span style="color:#A31515;"> Preparing</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#008000;"># 拒绝：请求的资源访问被拒绝</span></span>
<span class="line"><span style="color:#795E26;">denied:</span><span style="color:#A31515;"> requested</span><span style="color:#A31515;"> access</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> the</span><span style="color:#A31515;"> resource</span><span style="color:#A31515;"> is</span><span style="color:#A31515;"> denied</span><span style="color:#000000;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 问题：本地镜像名无帐号信息，解决加 tag即可</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> tag</span><span style="color:#A31515;"> 251ca4419332</span><span style="color:#A31515;"> kuangshen/diytomcat:1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 再次 push， ok</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker push kuangshen/diytomcat:1.0</span></span>
<span class="line"><span style="color:#795E26;">The</span><span style="color:#A31515;"> push</span><span style="color:#A31515;"> refers</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> repository</span><span style="color:#000000;"> [docker.io/kuangshen/diytomcat]</span></span>
<span class="line"><span style="color:#795E26;">0f02399c6fdf:</span><span style="color:#A31515;"> Pushing</span><span style="color:#000000;"> [========&gt;                                          </span><span style="color:#A31515;">]</span><span style="color:#A31515;">  9.729MB/59.76MB</span></span>
<span class="line"><span style="color:#795E26;">e79ea0c3a34e:</span><span style="color:#A31515;"> Pushing</span><span style="color:#000000;"> [==========&gt;                                        </span><span style="color:#A31515;">]</span><span style="color:#A31515;">  3.188MB/15.41MB</span></span>
<span class="line"><span style="color:#795E26;">09281fa8fe38:</span><span style="color:#A31515;"> Pushing</span><span style="color:#000000;"> [&gt;                                                  </span><span style="color:#A31515;">]</span><span style="color:#A31515;">  3.823MB/324MB</span></span>
<span class="line"><span style="color:#795E26;">b56a902b0aef:</span><span style="color:#A31515;"> Pushed</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">0683de282177:</span><span style="color:#A31515;"> Pushing</span><span style="color:#000000;"> [=&gt;                                                 </span><span style="color:#A31515;">]</span><span style="color:#A31515;">  5.997MB/237.1MB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>阿里云镜像服务</p></blockquote><p>1、登录阿里云</p><p>2、找到容器镜像服务</p><figure><img src="/assets/image-20200513190343991--OU6_9Bp.png" alt="image-20200513190343991" tabindex="0" loading="lazy"><figcaption>image-20200513190343991</figcaption></figure><p>3、创建命名空间</p><figure><img src="/assets/image-20200513190527541-BBfSZ-26.png" alt="image-20200513190527541" tabindex="0" loading="lazy"><figcaption>image-20200513190527541</figcaption></figure><p>4、创建镜像仓库</p><figure><img src="/assets/image-20200513190622096-Dzyp2O1H.png" alt="image-20200513190622096" tabindex="0" loading="lazy"><figcaption>image-20200513190622096</figcaption></figure><figure><img src="/assets/image-20200513190652953-BCe8r3BS.png" alt="image-20200513190652953" tabindex="0" loading="lazy"><figcaption>image-20200513190652953</figcaption></figure><p>5、点击进入这个镜像仓库，可以看到所有的信息</p><figure><img src="/assets/image-20200513190737320-BoAbvXTS.png" alt="image-20200513190737320" tabindex="0" loading="lazy"><figcaption>image-20200513190737320</figcaption></figure><p>6、测试推送发布</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 1、登录阿里云</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker login </span><span style="color:#001080;">--username</span><span style="color:#000000;">=</span><span style="color:#A31515;">18225148644</span><span style="color:#795E26;"> registry.cn-beijing.aliyuncs.com</span></span>
<span class="line"><span style="color:#795E26;">Password:</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">WARNING!</span><span style="color:#A31515;"> Your</span><span style="color:#A31515;"> password</span><span style="color:#A31515;"> will</span><span style="color:#A31515;"> be</span><span style="color:#A31515;"> stored</span><span style="color:#A31515;"> unencrypted</span><span style="color:#A31515;"> in</span><span style="color:#A31515;"> /root/.docker/config.json.</span></span>
<span class="line"><span style="color:#795E26;">Configure</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> credential</span><span style="color:#A31515;"> helper</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> remove</span><span style="color:#A31515;"> this</span><span style="color:#A31515;"> warning.</span><span style="color:#A31515;"> See</span></span>
<span class="line"><span style="color:#795E26;">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">Login</span><span style="color:#A31515;"> Succeeded</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 2、设置 tag</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> tag</span><span style="color:#000000;"> [ImageId] registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:[镜像版本号]</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker tag 251ca4419332 registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 3、推送命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> push</span><span style="color:#A31515;"> registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:[镜像版本号]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen tomcat]# docker push registry.cn-beijing.aliyuncs.com/bilibili-kuangshen/kuangshen-test:v1.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7、在阿里云镜像仓库查看效果！</p><figure><img src="/assets/image-20200513194743301-B70vvK_E.png" alt="image-20200513194743301" tabindex="0" loading="lazy"><figcaption>image-20200513194743301</figcaption></figure><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><figure><img src="/assets/image-20200511221705225-ClcLusNk.png" alt="image-20200511221705225" tabindex="0" loading="lazy"><figcaption>image-20200511221705225</figcaption></figure><h1 id="docker-网络讲解" tabindex="-1"><a class="header-anchor" href="#docker-网络讲解"><span>Docker 网络讲解</span></a></h1><h2 id="理解docker0" tabindex="-1"><a class="header-anchor" href="#理解docker0"><span>理解Docker0</span></a></h2><p>准备工作：清空所有的容器，清空所有的镜像</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rm</span><span style="color:#0000FF;"> -f</span><span style="color:#000000;"> $(</span><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -a</span><span style="color:#0000FF;"> -q</span><span style="color:#000000;">)             </span><span style="color:#008000;"># 删除所有容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> rmi</span><span style="color:#0000FF;"> -f</span><span style="color:#000000;"> $(</span><span style="color:#795E26;">docker</span><span style="color:#A31515;"> images</span><span style="color:#0000FF;"> -qa</span><span style="color:#000000;">)          </span><span style="color:#008000;"># 删除全部镜像</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Docker的网络也是十分重要的一个点，希望大家可以认真理解！</p><blockquote><p>我们先来做个测试</p></blockquote><p>查看本地ip <code>ip addr</code></p><figure><img src="/assets/image-20200513110026871-DslKMItp.png" alt="image-20200513110026871" tabindex="0" loading="lazy"><figcaption>image-20200513110026871</figcaption></figure><p>这里我们分析可得，有三个网络：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">lo</span><span style="color:#098658;">         127.0.0.1</span><span style="color:#008000;">       # 本机回环地址</span></span>
<span class="line"><span style="color:#795E26;">eth0</span><span style="color:#098658;">       172.17.90.138</span><span style="color:#008000;">   # 阿里云的私有IP</span></span>
<span class="line"><span style="color:#795E26;">docker0</span><span style="color:#098658;">    172.18.0.1</span><span style="color:#008000;">      # docker网桥</span></span>
<span class="line"><span style="color:#008000;"># 问题：Docker 是如何处理容器网络访问的？</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们之前安装ES的时候，留过一个问题，就是安装Kibana的问题，Kibana得指定ES的地址！或者我们实际场景中，我们开发了很多微服务项目，那些微服务项目都要连接数据库，需要指定数据库的url地址，通过ip。但是我们用Docker管理的话，假设数据库出问题了，我们重新启动运行一个，这个时候数据库的地址就会发生变化，docker会给每个容器都分配一个ip，且容器和容器之间是可以互相访问的。我们可以测试下容器之间能不能ping通过：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 启动tomcat01</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat01 tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看tomcat01的ip地址，docker会给每个容器都分配一个ip！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat01 ip addr</span></span>
<span class="line"><span style="color:#795E26;">1:</span><span style="color:#A31515;"> lo:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">LOOPBACK,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 65536</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UNKNOWN</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> qlen</span><span style="color:#098658;"> 1000</span></span>
<span class="line"><span style="color:#795E26;">    link/loopback</span><span style="color:#A31515;"> 00:00:00:00:00:00</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 127.0.0.1/8</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> host</span><span style="color:#A31515;"> lo</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span>
<span class="line"><span style="color:#795E26;">122:</span><span style="color:#A31515;"> eth0@if123:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UP</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 02:42:ac:12:00:02</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span><span style="color:#A31515;"> link-netnsid</span><span style="color:#098658;"> 0</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 172.18.0.2/16</span><span style="color:#A31515;"> brd</span><span style="color:#098658;"> 172.18.255.255</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> global</span><span style="color:#A31515;"> eth0</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span>
<span class="line"><span style="color:#000000;">       </span></span>
<span class="line"><span style="color:#008000;"># 思考，我们的linux服务器是否可以ping通容器内的tomcat  ？</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# ping 172.18.0.2</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#098658;"> 172.18.0.2</span><span style="color:#000000;"> (172.18.0.2) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> 172.18.0.2:</span><span style="color:#A31515;"> icmp_seq=</span><span style="color:#098658;">1</span><span style="color:#A31515;"> ttl=</span><span style="color:#098658;">64</span><span style="color:#A31515;"> time=</span><span style="color:#098658;">0.070</span><span style="color:#A31515;"> ms</span><span style="color:#008000;">  # 可以ping通！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>原理</p></blockquote><p>1、每一个安装了Docker的linux主机都有一个docker0的虚拟网卡。这是个桥接网卡，使用了veth-pair技术！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 我们再次查看主机的 ip addr</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# ip addr</span></span>
<span class="line"><span style="color:#795E26;">1:</span><span style="color:#A31515;"> lo:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">LOOPBACK,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 65536</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UNKNOWN</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> qlen</span><span style="color:#098658;"> 1000</span></span>
<span class="line"><span style="color:#795E26;">    link/loopback</span><span style="color:#A31515;"> 00:00:00:00:00:00</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 127.0.0.1/8</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> host</span><span style="color:#A31515;"> lo</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span>
<span class="line"><span style="color:#795E26;">2:</span><span style="color:#A31515;"> eth0:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> pfifo_fast</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UP</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> qlen</span><span style="color:#098658;"> 1000</span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 00:16:3e:30:27:f4</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 172.17.90.138/20</span><span style="color:#A31515;"> brd</span><span style="color:#098658;"> 172.17.95.255</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> global</span><span style="color:#A31515;"> dynamic</span><span style="color:#A31515;"> eth0</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> 310954997sec</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> 310954997sec</span></span>
<span class="line"><span style="color:#795E26;">3:</span><span style="color:#A31515;"> docker0:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UP</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 02:42:bb:71:07:06</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 172.18.0.1/16</span><span style="color:#A31515;"> brd</span><span style="color:#098658;"> 172.18.255.255</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> global</span><span style="color:#A31515;"> docker0</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span>
<span class="line"><span style="color:#795E26;">123:</span><span style="color:#A31515;"> vethc8584ea@if122:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> master</span><span style="color:#A31515;"> docker0</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UP</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 0a:4b:bb:40:78:a7</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span><span style="color:#A31515;"> link-netnsid</span><span style="color:#098658;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 发现：本来我们有三个网络，我们在启动了个tomcat容器之后，多了一个！123的网络！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、每启动一个容器，linux主机就会多了一个虚拟网卡。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 我们启动了一个tomcat01，主机的ip地址多了一个   123: vethc8584ea@if122</span></span>
<span class="line"><span style="color:#008000;"># 然后我们在tomcat01容器中查看容器的ip是        122: eth0@if123</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们再启动一个tomcat02观察</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat02 tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 然后发现linux主机上又多了一个网卡   125: veth021eeea@if124:</span></span>
<span class="line"><span style="color:#008000;"># 我们看下tomcat02的容器内ip地址是   124: eth0@if125:</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat02 ip addr</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h1 id="观察现象" tabindex="-1"><a class="header-anchor" href="#观察现象"><span>观察现象：</span></a></h1><h1 id="tomcat-linux主机-123-vethc8584ea-if122-容器内-eth0-if123" tabindex="-1"><a class="header-anchor" href="#tomcat-linux主机-123-vethc8584ea-if122-容器内-eth0-if123"><span>tomcat --- linux主机 123:vethc8584ea@if122 ---- 容器内 eth0@if123</span></a></h1><h1 id="tomcat-linux主机-125-veth021eeea-if124-容器内-eth0-if125" tabindex="-1"><a class="header-anchor" href="#tomcat-linux主机-125-veth021eeea-if124-容器内-eth0-if125"><span>tomcat --- linux主机 125:veth021eeea@if124 ---- 容器内 eth0@if125</span></a></h1><h1 id="相信到了这里-大家应该能看出点小猫腻了吧-只要启动一个容器-就有一对网卡" tabindex="-1"><a class="header-anchor" href="#相信到了这里-大家应该能看出点小猫腻了吧-只要启动一个容器-就有一对网卡"><span>相信到了这里，大家应该能看出点小猫腻了吧！只要启动一个容器，就有一对网卡</span></a></h1><h1 id="veth-pair-就是一对的虚拟设备接口-它都是成对出现的。一端连着协议栈-一端彼此相连着。" tabindex="-1"><a class="header-anchor" href="#veth-pair-就是一对的虚拟设备接口-它都是成对出现的。一端连着协议栈-一端彼此相连着。"><span>veth-pair 就是一对的虚拟设备接口，它都是成对出现的。一端连着协议栈，一端彼此相连着。</span></a></h1><h1 id="正因为有这个特性-它常常充当着一个桥梁-连接着各种虚拟网络设备" tabindex="-1"><a class="header-anchor" href="#正因为有这个特性-它常常充当着一个桥梁-连接着各种虚拟网络设备"><span>正因为有这个特性，它常常充当着一个桥梁，连接着各种虚拟网络设备!</span></a></h1><h1 id="bridge、ovs-之间的连接-docker-容器之间的连接-等等-以此构建出非常复杂的虚拟网络结构-比如-openstack-neutron。" tabindex="-1"><a class="header-anchor" href="#bridge、ovs-之间的连接-docker-容器之间的连接-等等-以此构建出非常复杂的虚拟网络结构-比如-openstack-neutron。"><span>“Bridge、OVS 之间的连接”，“Docker 容器之间的连接” 等等，以此构建出非常复杂的虚拟网络结构，比如 OpenStack Neutron。</span></a></h1></blockquote><p>3、我们来测试下tomcat01和tomcat02容器间是否可以互相ping通</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat02 ping 172.18.0.2</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#098658;"> 172.18.0.2</span><span style="color:#000000;"> (172.18.0.2) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> 172.18.0.2:</span><span style="color:#A31515;"> icmp_seq=</span><span style="color:#098658;">1</span><span style="color:#A31515;"> ttl=</span><span style="color:#098658;">64</span><span style="color:#A31515;"> time=</span><span style="color:#098658;">0.110</span><span style="color:#A31515;"> ms</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 结论：容器和容器之间是可以互相访问的。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4、我们来画一个网络模型图</p><figure><img src="/assets/image-20200513122215798-nhMAVPzM.png" alt="image-20200513122215798" tabindex="0" loading="lazy"><figcaption>image-20200513122215798</figcaption></figure><p>结论：tomcat1和tomcat2共用一个路由器。是的，他们使用的一个，就是docker0。任何一个容器启动默认都是docker0网络。 docker默认会给容器分配一个可用ip。</p><blockquote><p>小结</p></blockquote><p>Docker使用Linux桥接，在宿主机虚拟一个Docker容器网桥(docker0)，Docker启动一个容器时会根据Docker网桥的网段分配给容器一个IP地址，称为Container-IP，同时Docker网桥是每个容器的默认网关。因为在同一宿主机内的容器都接入同一个网桥，这样容器之间就能够通过容器的Container-IP直接通信。</p><figure><img src="/assets/image-20200513123128105-tx7MfpVv.png" alt="image-20200513123128105" tabindex="0" loading="lazy"><figcaption>image-20200513123128105</figcaption></figure><p>Docker容器网络就很好的利用了Linux虚拟网络技术，在本地主机和容器内分别创建一个虚拟接口，并让他们彼此联通（这样一对接口叫veth pair）；</p><p>Docker中的网络接口默认都是虚拟的接口。虚拟接口的优势就是转发效率极高（因为Linux是在内核中进行数据的复制来实现虚拟接口之间的数据转发，无需通过外部的网络设备交换），对于本地系统和容器系统来说，虚拟接口跟一个正常的以太网卡相比并没有区别，只是他的速度快很多。</p><h2 id="link" tabindex="-1"><a class="header-anchor" href="#link"><span>--Link</span></a></h2><p>思考一个场景，我们编写一个微服务，数据库连接地址原来是使用ip的，如果ip变化就不行了，那我们能不能使用服务名访问呢？</p><p>jdbc:mysql://mysql:3306，这样的话哪怕mysql重启，我们也不需要修改配置了！docker提供了 --link 的操作！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 我们使用tomcat02，直接通过容器名ping tomcat01，不使用ip</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat01</span></span>
<span class="line"><span style="color:#795E26;">ping:</span><span style="color:#A31515;"> tomcat01:</span><span style="color:#A31515;"> Name</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> service</span><span style="color:#A31515;"> not</span><span style="color:#A31515;"> known</span><span style="color:#008000;">  # 发现ping不通</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们再启动一个tomcat03，但是启动的时候连接tomcat02</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat03 --link tomcat02 tomcat</span></span>
<span class="line"><span style="color:#795E26;">a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 这个时候，我们就可以使用tomcat03 ping通tomcat02 了</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat03 ping tomcat02</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#A31515;"> tomcat02</span><span style="color:#000000;"> (172.18.0.3) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat02</span><span style="color:#000000;"> (172.18.0.3): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">1</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.093</span><span style="color:#795E26;"> ms</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat02</span><span style="color:#000000;"> (172.18.0.3): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">2</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.066</span><span style="color:#795E26;"> ms</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 再来测试，tomcat03 是否可以ping tomcat01    失败</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat03 ping tomcat01</span></span>
<span class="line"><span style="color:#795E26;">ping:</span><span style="color:#A31515;"> tomcat01:</span><span style="color:#A31515;"> Name</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> service</span><span style="color:#A31515;"> not</span><span style="color:#A31515;"> known</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 再来测试，tomcat02 是否可以ping tomcat03    反向也ping不通</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat03</span></span>
<span class="line"><span style="color:#795E26;">ping:</span><span style="color:#A31515;"> tomcat03:</span><span style="color:#A31515;"> Name</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> service</span><span style="color:#A31515;"> not</span><span style="color:#A31515;"> known</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>思考，这个原理是什么呢？我们进入tomcat03中查看下host配置文件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat03 cat /etc/hosts</span></span>
<span class="line"><span style="color:#795E26;">127.0.0.1</span><span style="color:#A31515;">	localhost</span></span>
<span class="line"><span style="color:#795E26;">:</span><span style="color:#A31515;">:1</span><span style="color:#A31515;">	localhost</span><span style="color:#A31515;"> ip6-localhost</span><span style="color:#A31515;"> ip6-loopback</span></span>
<span class="line"><span style="color:#795E26;">fe00::0</span><span style="color:#A31515;">	ip6-localnet</span></span>
<span class="line"><span style="color:#795E26;">ff00::0</span><span style="color:#A31515;">	ip6-mcastprefix</span></span>
<span class="line"><span style="color:#795E26;">ff02::1</span><span style="color:#A31515;">	ip6-allnodes</span></span>
<span class="line"><span style="color:#795E26;">ff02::2</span><span style="color:#A31515;">	ip6-allrouters</span></span>
<span class="line"><span style="color:#795E26;">172.18.0.3</span><span style="color:#A31515;">	tomcat02</span><span style="color:#A31515;"> b80da266a3ad</span><span style="color:#008000;">  # 发现tomcat2直接被写在这里</span></span>
<span class="line"><span style="color:#795E26;">172.18.0.4</span><span style="color:#A31515;">	a3a4a17a2b70</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 所以这里其实就是配置了一个 hosts 地址而已！</span></span>
<span class="line"><span style="color:#008000;"># 原因：--link的时候，直接把需要link的主机的域名和ip直接配置到了hosts文件中了。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>--link早都过时了，我们不推荐使用！我们可以使用自定义网络的方式</p><h2 id="自定义网络" tabindex="-1"><a class="header-anchor" href="#自定义网络"><span>自定义网络</span></a></h2><blockquote><p>基本命令查看</p></blockquote><p>命令如下：</p><figure><img src="/assets/image-20200513125918502-DwdDyly2.png" alt="image-20200513125918502" tabindex="0" loading="lazy"><figcaption>image-20200513125918502</figcaption></figure><p><strong>查看所有网络</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network ls</span></span>
<span class="line"><span style="color:#795E26;">NETWORK</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">          NAME</span><span style="color:#A31515;">                DRIVER</span><span style="color:#A31515;">              SCOPE</span></span>
<span class="line"><span style="color:#795E26;">4eb2182ac4b2</span><span style="color:#A31515;">        bridge</span><span style="color:#A31515;">              bridge</span><span style="color:#A31515;">              local</span></span>
<span class="line"><span style="color:#795E26;">ae2b6209c2ab</span><span style="color:#A31515;">        host</span><span style="color:#A31515;">                host</span><span style="color:#A31515;">                local</span></span>
<span class="line"><span style="color:#795E26;">c037f7ec7e57</span><span style="color:#A31515;">        none</span><span style="color:#A31515;">                null</span><span style="color:#A31515;">                local</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所有网路模式</p><table><thead><tr><th>网络模式</th><th>配置</th><th>说明</th></tr></thead><tbody><tr><td>bridge模式</td><td>--net=bridge</td><td>默认值，在Docker网桥docker0上为容器创建新的网络栈</td></tr><tr><td>none模式</td><td>--net=none</td><td>不配置网络，用户可以稍后进入容器，自行配置</td></tr><tr><td>container模式</td><td>--net=container:name/id</td><td>容器和另外一个容器共享Network namespace。 kubernetes中的pod就是多个容器共享一个Network namespace。</td></tr><tr><td>host模式</td><td>--net=host</td><td>容器和宿主机共享Network namespace</td></tr><tr><td>用户自定义</td><td>--net=自定义网络</td><td>用户自己使用network相关命令定义网络，创建容器的时候可以指定为自己定义的网络</td></tr></tbody></table><p><strong>查看一个具体的网络的详细信息</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 命令</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network inspect 4eb2182ac4b2</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;bridge&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Id&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;4eb2182ac4b23487e1eb6e06df56c71ab6f0adc7ccc0962b4747d0eed5ad6690&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Created&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;2020-05-11T15:44:20.131441544+08:00&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Scope&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;local&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Driver&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;bridge&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;EnableIPv6&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;IPAM&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Driver&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;default&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Options&quot;</span><span style="color:#000000;">: null,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Config&quot;</span><span style="color:#000000;">: [</span></span>
<span class="line"><span style="color:#000000;">                {</span></span>
<span class="line"><span style="color:#000000;">                    // 默认docker0是管理这个子网范围内的。0~16，也就是 255*255，去掉0个255，我们有65534可以分配的ip</span></span>
<span class="line"><span style="color:#000000;">                    // docker0网络默认可以支持创建6万多个容器ip不重复</span></span>
<span class="line"><span style="color:#A31515;">                    &quot;Subnet&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;172.18.0.0/16&quot;</span><span style="color:#000000;">, </span></span>
<span class="line"><span style="color:#A31515;">                    &quot;Gateway&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;172.18.0.1&quot;</span></span>
<span class="line"><span style="color:#000000;">                }</span></span>
<span class="line"><span style="color:#000000;">            ]</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Internal&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Attachable&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Ingress&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;ConfigFrom&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Network&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;ConfigOnly&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Containers&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;a3a4a17a2b707766ad4f2bb967ce1d94f658cd4cccef3bb8707395cdc71fa1e7&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat03&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;5fe62d0be3a1343aa74f6bb77885d3657b191210cafad200e5054e1bdfe56be9&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:ac:12:00:04&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;172.18.0.4/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            },</span></span>
<span class="line"><span style="color:#A31515;">            &quot;b80da266a3ad85fcc874c5f0d3c897246ebc40533cb745bb24180237cc3167b1&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;6232cac0c4e7fed30c9fa5eebc9238f9fc44f548f257344b5440d6d486825256&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:ac:12:00:03&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;172.18.0.3/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            },</span></span>
<span class="line"><span style="color:#A31515;">            &quot;f38239e2b405bccf8c93bd1052f336f661033b9b27ef9b3f99a018c108e06f87&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat01&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;31dc174b8f3f15f217acdc3ac7e8a235a03d59438f863706c0143b4426772c5e&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:ac:12:00:02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;172.18.0.2/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            }</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Options&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.bridge.default_bridge&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;true&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.bridge.enable_icc&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;true&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;true&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;0.0.0.0&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.bridge.name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;docker0&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;com.docker.network.driver.mtu&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;1500&quot;</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Labels&quot;</span><span style="color:#000000;">: {}</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>自定义网卡</p></blockquote><p>1、删除原来的所有容器</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker rm -f $(</span><span style="color:#795E26;">docker</span><span style="color:#A31515;"> ps</span><span style="color:#0000FF;"> -aq</span><span style="color:#000000;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 恢复到了最开始的样子</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# ip addr</span></span>
<span class="line"><span style="color:#795E26;">1:</span><span style="color:#A31515;"> lo:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">LOOPBACK,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 65536</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UNKNOWN</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> qlen</span><span style="color:#098658;"> 1000</span></span>
<span class="line"><span style="color:#795E26;">    link/loopback</span><span style="color:#A31515;"> 00:00:00:00:00:00</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 127.0.0.1/8</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> host</span><span style="color:#A31515;"> lo</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span>
<span class="line"><span style="color:#795E26;">2:</span><span style="color:#A31515;"> eth0:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> pfifo_fast</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> UP</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#A31515;"> qlen</span><span style="color:#098658;"> 1000</span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 00:16:3e:30:27:f4</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 172.17.90.138/20</span><span style="color:#A31515;"> brd</span><span style="color:#098658;"> 172.17.95.255</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> global</span><span style="color:#A31515;"> dynamic</span><span style="color:#A31515;"> eth0</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> 310951436sec</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> 310951436sec</span></span>
<span class="line"><span style="color:#795E26;">3:</span><span style="color:#A31515;"> docker0:</span><span style="color:#000000;"> &lt;</span><span style="color:#A31515;">NO-CARRIER,BROADCAST,MULTICAST,U</span><span style="color:#000000;">P&gt; </span><span style="color:#A31515;">mtu</span><span style="color:#098658;"> 1500</span><span style="color:#A31515;"> qdisc</span><span style="color:#A31515;"> noqueue</span><span style="color:#A31515;"> state</span><span style="color:#A31515;"> DOWN</span><span style="color:#A31515;"> group</span><span style="color:#A31515;"> default</span><span style="color:#000000;"> </span></span>
<span class="line"><span style="color:#795E26;">    link/ether</span><span style="color:#A31515;"> 02:42:bb:71:07:06</span><span style="color:#A31515;"> brd</span><span style="color:#A31515;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#795E26;">    inet</span><span style="color:#A31515;"> 172.18.0.1/16</span><span style="color:#A31515;"> brd</span><span style="color:#098658;"> 172.18.255.255</span><span style="color:#A31515;"> scope</span><span style="color:#A31515;"> global</span><span style="color:#A31515;"> docker0</span></span>
<span class="line"><span style="color:#795E26;">       valid_lft</span><span style="color:#A31515;"> forever</span><span style="color:#A31515;"> preferred_lft</span><span style="color:#A31515;"> forever</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、接下来我们来创建容器，但是我们知道默认创建的容器都是docker0网卡的</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 默认我们不配置网络，也就相当于默认值 --net bridge  使用的docker0</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -P</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> tomcat01</span><span style="color:#0000FF;"> --net</span><span style="color:#A31515;"> bridge</span><span style="color:#A31515;"> tomcat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># docker0网络的特点</span></span>
<span class="line"><span style="color:#795E26;">	1.它是默认的</span></span>
<span class="line"><span style="color:#795E26;">	2.域名访问不通</span></span>
<span class="line"><span style="color:#795E26;">	3.--link</span><span style="color:#A31515;"> 域名通了，但是删了又不行</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、我们可以让容器创建的时候使用自定义网络</p><figure><img src="/assets/image-20200513131526688-BZ_QMhoh.png" alt="image-20200513131526688" tabindex="0" loading="lazy"><figcaption>image-20200513131526688</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 自定义创建的默认default &quot;bridge&quot;</span></span>
<span class="line"><span style="color:#008000;"># 自定义创建一个网络网络</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span></span>
<span class="line"><span style="color:#795E26;">09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 确认下</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network ls</span></span>
<span class="line"><span style="color:#795E26;">NETWORK</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">          NAME</span><span style="color:#A31515;">                DRIVER</span><span style="color:#A31515;">              SCOPE</span></span>
<span class="line"><span style="color:#795E26;">4eb2182ac4b2</span><span style="color:#A31515;">        bridge</span><span style="color:#A31515;">              bridge</span><span style="color:#A31515;">              local</span></span>
<span class="line"><span style="color:#795E26;">ae2b6209c2ab</span><span style="color:#A31515;">        host</span><span style="color:#A31515;">                host</span><span style="color:#A31515;">                local</span></span>
<span class="line"><span style="color:#795E26;">09bd09d8d3a6</span><span style="color:#A31515;">        mynet</span><span style="color:#A31515;">               bridge</span><span style="color:#A31515;">              local</span></span>
<span class="line"><span style="color:#795E26;">c037f7ec7e57</span><span style="color:#A31515;">        none</span><span style="color:#A31515;">                null</span><span style="color:#A31515;">                local</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network inspect mynet</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;mynet&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Id&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Created&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;2020-05-13T13:29:33.568644836+08:00&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Scope&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;local&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Driver&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;bridge&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;EnableIPv6&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;IPAM&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Driver&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;default&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Options&quot;</span><span style="color:#000000;">: {},</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Config&quot;</span><span style="color:#000000;">: [</span></span>
<span class="line"><span style="color:#000000;">                {</span></span>
<span class="line"><span style="color:#A31515;">                    &quot;Subnet&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.0/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                    &quot;Gateway&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.1&quot;</span></span>
<span class="line"><span style="color:#000000;">                }</span></span>
<span class="line"><span style="color:#000000;">            ]</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Internal&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Attachable&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Ingress&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;ConfigFrom&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;Network&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;ConfigOnly&quot;</span><span style="color:#000000;">: </span><span style="color:#0000FF;">false</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Containers&quot;</span><span style="color:#000000;">: {},</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Options&quot;</span><span style="color:#000000;">: {},</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Labels&quot;</span><span style="color:#000000;">: {}</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们来启动两个容器测试，使用自己的 mynet！</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat</span></span>
<span class="line"><span style="color:#795E26;">065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat</span></span>
<span class="line"><span style="color:#795E26;">2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">            PORTS</span><span style="color:#A31515;">                     NAMES</span></span>
<span class="line"><span style="color:#795E26;">2e85d71afe87</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">           0.0.0.0:32772</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat-net-02</span></span>
<span class="line"><span style="color:#795E26;">065f82e947c7</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">           0.0.0.0:32771</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat-net-01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 再来查看下</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network inspect mynet</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;mynet&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Id&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;09bd09d8d3a6b33e6d19f49643dab551e5a45818baf4d5328aa7320c6dcfc236&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#000000;">        ............</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Containers&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat-net-01&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:c0:a8:00:02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.2/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            },</span></span>
<span class="line"><span style="color:#A31515;">            &quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat-net-02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:c0:a8:00:03&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.3/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            }</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Options&quot;</span><span style="color:#000000;">: {},</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Labels&quot;</span><span style="color:#000000;">: {}</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们来测试ping容器名和ip试试，都可以ping通</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat-net-01 ping 192.168.0.3</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#098658;"> 192.168.0.3</span><span style="color:#000000;"> (192.168.0.3) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> 192.168.0.3:</span><span style="color:#A31515;"> icmp_seq=</span><span style="color:#098658;">1</span><span style="color:#A31515;"> ttl=</span><span style="color:#098658;">64</span><span style="color:#A31515;"> time=</span><span style="color:#098658;">0.093</span><span style="color:#A31515;"> ms</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat-net-01 ping tomcat-net-02</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#A31515;"> tomcat-net-02</span><span style="color:#000000;"> (192.168.0.3) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat-net-02.mynet</span><span style="color:#000000;"> (192.168.0.3): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">1</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.063</span><span style="color:#795E26;"> ms</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat-net-02.mynet</span><span style="color:#000000;"> (192.168.0.3): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">2</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.066</span><span style="color:#795E26;"> ms</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 发现，我们自定义的网络docker都已经帮我们维护好了对应的关系</span></span>
<span class="line"><span style="color:#008000;"># 所以我们平时都可以这样使用网络，不使用--link效果一样，所有东西实时维护好，直接域名 ping 通。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>聊了这么多，我们现在应该可以深刻理解docker的网络了！</p><h2 id="网络连通" tabindex="-1"><a class="header-anchor" href="#网络连通"><span>网络连通</span></a></h2><figure><img src="/assets/image-20200513134439676-BiZWqzHf.png" alt="image-20200513134439676" tabindex="0" loading="lazy"><figcaption>image-20200513134439676</figcaption></figure><p>docker0和自定义网络肯定不通，我们使用自定义网络的好处就是网络隔离：</p><p>大家公司项目部署的业务都非常多，假设我们有一个商城，我们会有订单业务（操作不同数据），会有订单业务购物车业务（操作不同缓存）。如果在一个网络下，有的程序猿的恶意代码就不能防止了，所以我们就在部署的时候网络隔离，创建两个桥接网卡，比如订单业务（里面的数据库，redis，mq，全部业务 都在order-net网络下）其他业务在其他网络。</p><p>那关键的问题来了，如何让 tomcat-net-01 访问 tomcat1？</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 启动默认的容器，在docker0网络下</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat01 tomcat</span></span>
<span class="line"><span style="color:#795E26;">bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker run -d -P --name tomcat02 tomcat</span></span>
<span class="line"><span style="color:#795E26;">6183aaeca003a3e5a3549a37f9c1040551320ae358807b4aaad547a986afb887</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看当前的容器</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">                PORTS</span><span style="color:#A31515;">                     NAMES</span></span>
<span class="line"><span style="color:#795E26;">6183aaeca003</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">               0.0.0.0:32774</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat02</span></span>
<span class="line"><span style="color:#795E26;">bcd122e0dcf6</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">               0.0.0.0:32773</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat01</span></span>
<span class="line"><span style="color:#795E26;">2e85d71afe87</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">               0.0.0.0:32772</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat-net-02</span></span>
<span class="line"><span style="color:#795E26;">065f82e947c7</span><span style="color:#A31515;">        tomcat</span><span style="color:#A31515;">               0.0.0.0:32771</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   tomcat-net-01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们来查看下network帮助，发现一个命令 connect</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network --help</span></span>
<span class="line"><span style="color:#795E26;">Commands:</span></span>
<span class="line"><span style="color:#795E26;">  connect</span><span style="color:#A31515;">     Connect</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> to</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> network</span><span style="color:#008000;">  # 连接一个容器到一个网络</span></span>
<span class="line"><span style="color:#795E26;">  create</span><span style="color:#A31515;">      Create</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> network</span></span>
<span class="line"><span style="color:#795E26;">  disconnect</span><span style="color:#A31515;">  Disconnect</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> container</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> a</span><span style="color:#A31515;"> network</span></span>
<span class="line"><span style="color:#795E26;">  inspect</span><span style="color:#A31515;">     Display</span><span style="color:#A31515;"> detailed</span><span style="color:#A31515;"> information</span><span style="color:#A31515;"> on</span><span style="color:#A31515;"> one</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> more</span><span style="color:#A31515;"> networks</span></span>
<span class="line"><span style="color:#795E26;">  ls</span><span style="color:#A31515;">          List</span><span style="color:#A31515;"> networks</span></span>
<span class="line"><span style="color:#795E26;">  prune</span><span style="color:#A31515;">       Remove</span><span style="color:#A31515;"> all</span><span style="color:#A31515;"> unused</span><span style="color:#A31515;"> networks</span></span>
<span class="line"><span style="color:#795E26;">  rm</span><span style="color:#A31515;">          Remove</span><span style="color:#A31515;"> one</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> more</span><span style="color:#A31515;"> networks</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 我们来测试一下！打通mynet-docker0</span></span>
<span class="line"><span style="color:#008000;"># 命令 docker network connect [OPTIONS] NETWORK CONTAINER</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network connect mynet tomcat01</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker network inspect mynet</span></span>
<span class="line"><span style="color:#000000;">[</span></span>
<span class="line"><span style="color:#000000;">    {</span></span>
<span class="line"><span style="color:#000000;">        ......</span></span>
<span class="line"><span style="color:#A31515;">        &quot;Containers&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">            &quot;065f82e947c760c63539ab4c0de0d683787ec7ac6d0dcaa71f64e191319f9fe7&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat-net-01&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;d61cef1bc294d7f10fb6d9b728735fc87bed79e4e02f5298374f0fab3e9b2da6&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:c0:a8:00:02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.2/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            },</span></span>
<span class="line"><span style="color:#A31515;">            &quot;2e85d71afe87c87166786b0bbae2d90eefb969d716fcd78a21173add5956cb12&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat-net-02&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;adbc37a20526c2985c3589382998a3d106ef722662c7b296a57d8a7c8f449f38&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:c0:a8:00:03&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.3/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            },</span></span>
<span class="line"><span style="color:#000000;">            // 发现我们的tomcat01就进来这里了，tomcat01拥有了双ip</span></span>
<span class="line"><span style="color:#A31515;">            &quot;bcd122e0dcf6bf8c861eaa934911f98a5497a4954f3fde9575e496160bd23287&quot;</span><span style="color:#000000;">: {</span></span>
<span class="line"><span style="color:#A31515;">                &quot;Name&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;tomcat01&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;EndpointID&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;b2bf2342948e17048d872a4d5603c77e90d0e032439d510e86c10a1acc3928d9&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;MacAddress&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;02:42:c0:a8:00:04&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv4Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;192.168.0.4/16&quot;</span><span style="color:#000000;">,</span></span>
<span class="line"><span style="color:#A31515;">                &quot;IPv6Address&quot;</span><span style="color:#000000;">: </span><span style="color:#A31515;">&quot;&quot;</span></span>
<span class="line"><span style="color:#000000;">            }</span></span>
<span class="line"><span style="color:#000000;">        },</span></span>
<span class="line"><span style="color:#000000;">        ......</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"><span style="color:#000000;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># tomcat01 可以ping通了</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat01 ping tomcat-net-01</span></span>
<span class="line"><span style="color:#795E26;">PING</span><span style="color:#A31515;"> tomcat-net-01</span><span style="color:#000000;"> (192.168.0.2) 56(</span><span style="color:#795E26;">84</span><span style="color:#000000;">) bytes of data.</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat-net-01.mynet</span><span style="color:#000000;"> (192.168.0.2): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">1</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.071</span><span style="color:#795E26;"> ms</span></span>
<span class="line"><span style="color:#795E26;">64</span><span style="color:#A31515;"> bytes</span><span style="color:#A31515;"> from</span><span style="color:#A31515;"> tomcat-net-01.mynet</span><span style="color:#000000;"> (192.168.0.2): </span><span style="color:#001080;">icmp_seq</span><span style="color:#000000;">=</span><span style="color:#A31515;">2</span><span style="color:#001080;"> ttl</span><span style="color:#000000;">=</span><span style="color:#A31515;">64</span><span style="color:#001080;"> time</span><span style="color:#000000;">=</span><span style="color:#A31515;">0.067</span><span style="color:#795E26;"> ms</span></span>
<span class="line"><span style="color:#008000;"># tomcat02 依旧ping不通，大家应该就理解了</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker exec -it tomcat02 ping tomcat-net-01</span></span>
<span class="line"><span style="color:#795E26;">ping:</span><span style="color:#A31515;"> tomcat-net-01:</span><span style="color:#A31515;"> Name</span><span style="color:#A31515;"> or</span><span style="color:#A31515;"> service</span><span style="color:#A31515;"> not</span><span style="color:#A31515;"> known</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结论：如果要跨网络操作别人，就需要使用 <code>docker network connect [OPTIONS] NETWORK CONTAINER</code> 连接</p><h2 id="实战-部署一个redis集群" tabindex="-1"><a class="header-anchor" href="#实战-部署一个redis集群"><span>实战：部署一个Redis集群</span></a></h2><figure><img src="/assets/image-20200513144825113-COTvE5_h.png" alt="image-20200513144825113" tabindex="0" loading="lazy"><figcaption>image-20200513144825113</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#008000;"># 创建网卡</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> network</span><span style="color:#A31515;"> create</span><span style="color:#A31515;"> redis</span><span style="color:#0000FF;"> --subnet</span><span style="color:#A31515;"> 172.38.0.0/16</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 通过脚本创建六个redis配置</span></span>
<span class="line"><span style="color:#AF00DB;">for</span><span style="color:#001080;"> port</span><span style="color:#AF00DB;"> in</span><span style="color:#000000;"> $(</span><span style="color:#795E26;">seq</span><span style="color:#098658;"> 1</span><span style="color:#098658;"> 6</span><span style="color:#000000;">); </span><span style="color:#EE0000;">\</span></span>
<span class="line"><span style="color:#AF00DB;">do</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#795E26;">mkdir</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> /mydata/redis/node-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">/conf</span></span>
<span class="line"><span style="color:#795E26;">touch</span><span style="color:#A31515;"> /mydata/redis/node-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">/conf/redis.conf</span></span>
<span class="line"><span style="color:#795E26;">cat</span><span style="color:#000000;"> &lt;&lt; </span><span style="color:#000000;">EOF</span><span style="color:#000000;"> &gt;</span><span style="color:#A31515;">/mydata/redis/node-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#795E26;">/conf/redis.conf</span></span>
<span class="line"><span style="color:#A31515;">port 6379</span></span>
<span class="line"><span style="color:#A31515;">bind 0.0.0.0</span></span>
<span class="line"><span style="color:#A31515;">cluster-enabled yes</span></span>
<span class="line"><span style="color:#A31515;">cluster-config-file nodes.conf</span></span>
<span class="line"><span style="color:#A31515;">cluster-node-timeout 5000</span></span>
<span class="line"><span style="color:#A31515;">cluster-announce-ip 172.38.0.1${</span><span style="color:#001080;">port</span><span style="color:#A31515;">}</span></span>
<span class="line"><span style="color:#A31515;">cluster-announce-port 6379</span></span>
<span class="line"><span style="color:#A31515;">cluster-announce-bus-port 16379</span></span>
<span class="line"><span style="color:#A31515;">appendonly yes</span></span>
<span class="line"><span style="color:#000000;">EOF</span></span>
<span class="line"><span style="color:#AF00DB;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -p</span><span style="color:#098658;"> 637</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">:6379</span><span style="color:#0000FF;"> -p</span><span style="color:#098658;"> 1637</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">:16379</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> redis-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">} </span><span style="color:#EE0000;">\</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">/data:/data</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">}</span><span style="color:#A31515;">/conf/redis.conf:/etc/redis/redis.conf</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-d </span><span style="color:#0000FF;">--net</span><span style="color:#A31515;"> redis</span><span style="color:#0000FF;"> --ip</span><span style="color:#098658;"> 172.38.0.1</span><span style="color:#000000;">${</span><span style="color:#001080;">port</span><span style="color:#000000;">} </span><span style="color:#A31515;">redis:5.0.9-alpine3.11</span><span style="color:#A31515;"> redis-server</span><span style="color:#A31515;"> /etc/redis/redis.conf</span><span style="color:#000000;">; </span><span style="color:#EE0000;">\</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 启动6个容器</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 6371:6379</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 16371:16379</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> redis-1</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-1/data:/data</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-d </span><span style="color:#0000FF;">--net</span><span style="color:#A31515;"> redis</span><span style="color:#0000FF;"> --ip</span><span style="color:#098658;"> 172.38.0.11</span><span style="color:#A31515;"> redis:5.0.9-alpine3.11</span><span style="color:#A31515;"> redis-server</span><span style="color:#A31515;"> /etc/redis/redis.conf</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 6376:6379</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 16376:16379</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> redis-6</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-6/data:/data</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-v </span><span style="color:#A31515;">/mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf</span><span style="color:#EE0000;"> \</span></span>
<span class="line"><span style="color:#000000;">-d </span><span style="color:#0000FF;">--net</span><span style="color:#A31515;"> redis</span><span style="color:#0000FF;"> --ip</span><span style="color:#098658;"> 172.38.0.16</span><span style="color:#A31515;"> redis:5.0.9-alpine3.11</span><span style="color:#A31515;"> redis-server</span><span style="color:#A31515;"> /etc/redis/redis.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 进入一个redis，注意这里是 sh命令</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> exec</span><span style="color:#0000FF;"> -it</span><span style="color:#A31515;"> redis-1</span><span style="color:#A31515;"> /bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 创建集群</span></span>
<span class="line"><span style="color:#795E26;">redis-cli</span><span style="color:#0000FF;"> --cluster</span><span style="color:#A31515;"> create</span><span style="color:#A31515;"> 172.38.0.11:6379</span><span style="color:#A31515;"> 172.38.0.12:6379</span><span style="color:#A31515;"> 172.38.0.13:6379</span><span style="color:#A31515;"> 172.38.0.14:6379</span><span style="color:#A31515;"> 172.38.0.15:6379</span><span style="color:#A31515;"> 172.38.0.16:6379</span><span style="color:#0000FF;"> --cluster-replicas</span><span style="color:#098658;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 连接集群</span></span>
<span class="line"><span style="color:#795E26;">redis-cli</span><span style="color:#0000FF;"> -c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看集群信息</span></span>
<span class="line"><span style="color:#795E26;">cluster</span><span style="color:#A31515;"> info</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看节点</span></span>
<span class="line"><span style="color:#795E26;">cluster</span><span style="color:#A31515;"> nodes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># set a b</span></span>
<span class="line"><span style="color:#008000;"># 停止到存值的容器</span></span>
<span class="line"><span style="color:#008000;"># 然后再次get a，发现依旧可以获取值</span></span>
<span class="line"><span style="color:#008000;"># 查看节点，发现高可用完全没问题</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="idea整合docker" tabindex="-1"><a class="header-anchor" href="#idea整合docker"><span>IDEA整合Docker</span></a></h1><h2 id="创建项目" tabindex="-1"><a class="header-anchor" href="#创建项目"><span>创建项目</span></a></h2><p>1、使用 IDEA 构建一个 SpringBoot 项目</p><p>2、编写一个helloController</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">@RestController</span></span>
<span class="line"><span style="color:#795E26;">public</span><span style="color:#A31515;"> class</span><span style="color:#A31515;"> HelloController</span><span style="color:#A31515;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">    @GetMapping(</span><span style="color:#795E26;">&quot;/hello&quot;</span><span style="color:#000000;">)</span></span>
<span class="line"><span style="color:#795E26;">    public</span><span style="color:#A31515;"> String</span><span style="color:#A31515;"> hello</span><span style="color:#000000;">()</span><span style="color:#A31515;">{</span></span>
<span class="line"><span style="color:#AF00DB;">        return</span><span style="color:#A31515;"> &quot;hello,kuangshen&quot;</span><span style="color:#000000;">;</span></span>
<span class="line"><span style="color:#000000;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、启动测试下，端口修改下，避免8080冲突！本地访问没问题就可以！</p><p>4、打jar包</p><figure><img src="/assets/image-20200514120405514-C1zKRcG1.png" alt="image-20200514120405514" tabindex="0" loading="lazy"><figcaption>image-20200514120405514</figcaption></figure><p>有了 jar 包，我们就可以作镜像了！ 记得测试一下jar包可以使用吗！</p><h2 id="打包镜像" tabindex="-1"><a class="header-anchor" href="#打包镜像"><span>打包镜像</span></a></h2><p>1、在项目下编写 Dockerfile 文件，将打包好的jar包拷贝到Dockerfile同级目录</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#795E26;">FROM</span><span style="color:#A31515;"> java:8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 服务器只有dockerfile和jar在同级目录</span></span>
<span class="line"><span style="color:#795E26;">COPY</span><span style="color:#0000FF;"> *</span><span style="color:#A31515;">.jar</span><span style="color:#A31515;"> /app.jar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">CMD</span><span style="color:#000000;"> [</span><span style="color:#A31515;">&quot;--server.port=8080&quot;</span><span style="color:#000000;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 指定容器内要暴露的端口</span></span>
<span class="line"><span style="color:#795E26;">EXPOSE</span><span style="color:#098658;"> 8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#795E26;">ENTRYPOINT</span><span style="color:#000000;"> [</span><span style="color:#A31515;">&quot;java&quot;</span><span style="color:#000000;">,</span><span style="color:#A31515;">&quot;-jar&quot;</span><span style="color:#000000;">,</span><span style="color:#A31515;">&quot;/app.jar&quot;</span><span style="color:#000000;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、将Dockerfile 和 项目的 jar 包上传到linux服务器上，构建运行</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#FFFFFF;color:#000000;"><pre class="shiki light-plus vp-code"><code><span class="line"><span style="color:#000000;">[root@kuangshen idea]# pwd</span></span>
<span class="line"><span style="color:#795E26;">/home/idea</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen idea]# ll</span></span>
<span class="line"><span style="color:#795E26;">total</span><span style="color:#098658;"> 17228</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;"> 17634294</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 14</span><span style="color:#A31515;"> 12:33</span><span style="color:#A31515;"> demo-0.0.1-SNAPSHOT.jar</span></span>
<span class="line"><span style="color:#795E26;">-rw-r--r--</span><span style="color:#098658;"> 1</span><span style="color:#A31515;"> root</span><span style="color:#A31515;"> root</span><span style="color:#098658;">      207</span><span style="color:#A31515;"> May</span><span style="color:#098658;"> 14</span><span style="color:#A31515;"> 12:32</span><span style="color:#A31515;"> Dockerfile</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 构建镜像</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> build</span><span style="color:#0000FF;"> -t</span><span style="color:#A31515;"> kuangstudy</span><span style="color:#A31515;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 查看镜像</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> images</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 运行</span></span>
<span class="line"><span style="color:#795E26;">docker</span><span style="color:#A31515;"> run</span><span style="color:#0000FF;"> -d</span><span style="color:#0000FF;"> -p</span><span style="color:#A31515;"> 8080:8080</span><span style="color:#0000FF;"> --name</span><span style="color:#A31515;"> kuangstudy</span><span style="color:#A31515;"> kuangstudy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# docker ps</span></span>
<span class="line"><span style="color:#795E26;">CONTAINER</span><span style="color:#A31515;"> ID</span><span style="color:#A31515;">        IMAGE</span><span style="color:#A31515;">               PORTS</span><span style="color:#A31515;">                     NAMES</span></span>
<span class="line"><span style="color:#795E26;">2366c960ba99</span><span style="color:#A31515;">        kuangstudy</span><span style="color:#A31515;">             0.0.0.0:32779</span><span style="color:#000000;">-&gt;</span><span style="color:#A31515;">8080/tcp</span><span style="color:#A31515;">   kuangstudy1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#008000;"># 测试访问</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# curl localhost:32779</span></span>
<span class="line"><span style="color:#000000;">[root@kuangshen ~]# curl localhost:32779/hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="idea安装插件" tabindex="-1"><a class="header-anchor" href="#idea安装插件"><span>IDEA安装插件</span></a></h2><p>了解即可！以后CI/CD，就完全没必要这样做！</p><p>1、IDEA安装插件</p><figure><img src="/assets/image-20200514124357792-CWpJIX7j.png" alt="image-20200514124357792" tabindex="0" loading="lazy"><figcaption>image-20200514124357792</figcaption></figure><p>2、配置docker连接集成</p><figure><img src="/assets/image-20200514124439568-B79-CTRN.png" alt="image-20200514124439568" tabindex="0" loading="lazy"><figcaption>image-20200514124439568</figcaption></figure><p>3、集成了docker插件就可以在IDEA中操作Docker内部的容器和镜像了，但是很鸡肋这个功能，对于我们开发人员来说！</p><p>之后学习的CI/CD才是真正在企业中的王道！</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/posts/docker/README.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1874764803@qq.com">普通市民梁生</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">cv</div><div class="vp-copyright">Copyright © 2024 cv </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BzPplCq-.js" defer></script>
  </body>
</html>
